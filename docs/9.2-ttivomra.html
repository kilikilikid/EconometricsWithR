<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9.2 Threats to Internal Validity of Multiple Regression Analysis | Introduction to Econometrics with R</title>
  <meta name="description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="9.2 Threats to Internal Validity of Multiple Regression Analysis | Introduction to Econometrics with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://www.econometrics-with-r.org//images/cover.png" />
  <meta property="og:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="github-repo" content="mca91/EconometricsWithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9.2 Threats to Internal Validity of Multiple Regression Analysis | Introduction to Econometrics with R" />
  
  <meta name="twitter:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="twitter:image" content="https://www.econometrics-with-r.org//images/cover.png" />

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber, and Martin Schmelzer" />


<meta name="date" content="2025-07-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="9.1-internal-and-external-validity.html"/>
<link rel="next" href="9.3-internal-and-external-validity-when-the-regression-is-used-for-forecasting.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<!-- font families -->

<link href="https://fonts.googleapis.com/css?family=PT+Sans|Pacifico|Source+Sans+Pro" rel="stylesheet">

<script src="js/hideOutput.js"></script>

<!-- Mathjax -->
<script type="text/javascript" id="MathJax-script" async
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/mml-chtml.min.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
extensions: ["tex2jax.js", "TeX/AMSmath.js"],
tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
jax: ["input/TeX","output/CommonHTML"]
});
MathJax.Hub.processSectionDelay = 0;
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-110299877-1');
</script>

<!-- open review block -->

<script type="application/json" class="js-hypothesis-config">
{
"showHighlights": false
}
</script>
<script async defer src="https://hypothes.is/embed.js"></script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><center><img src="images/logo.png" alt="logo" width="50%" height="50%"style="margin: 15px 0 0 0"></center></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="1-introduction.html"><a href="1-introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-colophon.html"><a href="1.1-colophon.html"><i class="fa fa-check"></i><b>1.1</b> Colophon</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-a-very-short-introduction-to-r-and-rstudio.html"><a href="1.2-a-very-short-introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1.2</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-pt.html"><a href="2-pt.html"><i class="fa fa-check"></i><b>2</b> Probability Theory</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-random-variables-and-probability-distributions.html"><a href="2.1-random-variables-and-probability-distributions.html"><i class="fa fa-check"></i><b>2.1</b> Random Variables and Probability Distributions</a>
<ul>
<li class="chapter" data-level="" data-path="2.1-random-variables-and-probability-distributions.html"><a href="2.1-random-variables-and-probability-distributions.html#probability-distributions-of-discrete-random-variables"><i class="fa fa-check"></i>Probability Distributions of Discrete Random Variables</a></li>
<li class="chapter" data-level="" data-path="2.1-random-variables-and-probability-distributions.html"><a href="2.1-random-variables-and-probability-distributions.html#bernoulli-trials"><i class="fa fa-check"></i>Bernoulli Trials</a></li>
<li class="chapter" data-level="" data-path="2.1-random-variables-and-probability-distributions.html"><a href="2.1-random-variables-and-probability-distributions.html#expected-value-mean-and-variance"><i class="fa fa-check"></i>Expected Value, Mean and Variance</a></li>
<li class="chapter" data-level="" data-path="2.1-random-variables-and-probability-distributions.html"><a href="2.1-random-variables-and-probability-distributions.html#probability-distributions-of-continuous-random-variables"><i class="fa fa-check"></i>Probability Distributions of Continuous Random Variables</a></li>
<li class="chapter" data-level="" data-path="2.1-random-variables-and-probability-distributions.html"><a href="2.1-random-variables-and-probability-distributions.html#the-normal-distribution"><i class="fa fa-check"></i>The Normal Distribution</a></li>
<li class="chapter" data-level="" data-path="2.1-random-variables-and-probability-distributions.html"><a href="2.1-random-variables-and-probability-distributions.html#the-chi-squared-distribution"><i class="fa fa-check"></i>The Chi-Squared Distribution</a></li>
<li class="chapter" data-level="" data-path="2.1-random-variables-and-probability-distributions.html"><a href="2.1-random-variables-and-probability-distributions.html#thetdist"><i class="fa fa-check"></i>The Student t Distribution</a></li>
<li class="chapter" data-level="" data-path="2.1-random-variables-and-probability-distributions.html"><a href="2.1-random-variables-and-probability-distributions.html#the-f-distribution"><i class="fa fa-check"></i>The F Distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2.2-RSATDOSA.html"><a href="2.2-RSATDOSA.html"><i class="fa fa-check"></i><b>2.2</b> Random Sampling and the Distribution of Sample Averages</a>
<ul>
<li class="chapter" data-level="" data-path="2.2-RSATDOSA.html"><a href="2.2-RSATDOSA.html#mean-and-variance-of-the-sample-mean"><i class="fa fa-check"></i>Mean and Variance of the Sample Mean</a></li>
<li class="chapter" data-level="" data-path="2.2-RSATDOSA.html"><a href="2.2-RSATDOSA.html#large-sample-approximations-to-sampling-distributions"><i class="fa fa-check"></i>Large Sample Approximations to Sampling Distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2.3-exercises-2.html"><a href="2.3-exercises-2.html"><i class="fa fa-check"></i><b>2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-arosur.html"><a href="3-arosur.html"><i class="fa fa-check"></i><b>3</b> A Review of Statistics using R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-estimation-of-the-population-mean.html"><a href="3.1-estimation-of-the-population-mean.html"><i class="fa fa-check"></i><b>3.1</b> Estimation of the Population Mean</a></li>
<li class="chapter" data-level="3.2" data-path="3.2-potsm.html"><a href="3.2-potsm.html"><i class="fa fa-check"></i><b>3.2</b> Properties of the Sample Mean</a></li>
<li class="chapter" data-level="3.3" data-path="3.3-hypothesis-tests-concerning-the-population-mean.html"><a href="3.3-hypothesis-tests-concerning-the-population-mean.html"><i class="fa fa-check"></i><b>3.3</b> Hypothesis Tests concerning the Population Mean</a>
<ul>
<li class="chapter" data-level="" data-path="3.3-hypothesis-tests-concerning-the-population-mean.html"><a href="3.3-hypothesis-tests-concerning-the-population-mean.html#the-p-value"><i class="fa fa-check"></i>The p-Value</a></li>
<li class="chapter" data-level="" data-path="3.3-hypothesis-tests-concerning-the-population-mean.html"><a href="3.3-hypothesis-tests-concerning-the-population-mean.html#calculating-the-p-value-when-the-standard-deviation-is-known"><i class="fa fa-check"></i>Calculating the p-Value when the Standard Deviation is Known</a></li>
<li class="chapter" data-level="" data-path="3.3-hypothesis-tests-concerning-the-population-mean.html"><a href="3.3-hypothesis-tests-concerning-the-population-mean.html#SVSSDASE"><i class="fa fa-check"></i>Sample Variance, Sample Standard Deviation and Standard Error</a></li>
<li class="chapter" data-level="" data-path="3.3-hypothesis-tests-concerning-the-population-mean.html"><a href="3.3-hypothesis-tests-concerning-the-population-mean.html#calculating-the-p-value-when-the-standard-deviation-is-unknown"><i class="fa fa-check"></i>Calculating the p-value When the Standard Deviation is Unknown</a></li>
<li class="chapter" data-level="" data-path="3.3-hypothesis-tests-concerning-the-population-mean.html"><a href="3.3-hypothesis-tests-concerning-the-population-mean.html#the-t-statistic"><i class="fa fa-check"></i>The t-statistic</a></li>
<li class="chapter" data-level="" data-path="3.3-hypothesis-tests-concerning-the-population-mean.html"><a href="3.3-hypothesis-tests-concerning-the-population-mean.html#hypothesis-testing-with-a-prespecified-significance-level"><i class="fa fa-check"></i>Hypothesis Testing with a Prespecified Significance Level</a></li>
<li class="chapter" data-level="" data-path="3.3-hypothesis-tests-concerning-the-population-mean.html"><a href="3.3-hypothesis-tests-concerning-the-population-mean.html#one-sided-alternatives"><i class="fa fa-check"></i>One-sided Alternatives</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3.4-confidence-intervals-for-the-population-mean.html"><a href="3.4-confidence-intervals-for-the-population-mean.html"><i class="fa fa-check"></i><b>3.4</b> Confidence Intervals for the Population Mean</a></li>
<li class="chapter" data-level="3.5" data-path="3.5-cmfdp.html"><a href="3.5-cmfdp.html"><i class="fa fa-check"></i><b>3.5</b> Comparing Means from Different Populations</a></li>
<li class="chapter" data-level="3.6" data-path="3.6-aattggoe.html"><a href="3.6-aattggoe.html"><i class="fa fa-check"></i><b>3.6</b> An Application to the Gender Gap of Earnings</a></li>
<li class="chapter" data-level="3.7" data-path="3.7-scatterplots-sample-covariance-and-sample-correlation.html"><a href="3.7-scatterplots-sample-covariance-and-sample-correlation.html"><i class="fa fa-check"></i><b>3.7</b> Scatterplots, Sample Covariance and Sample Correlation</a></li>
<li class="chapter" data-level="3.8" data-path="3.8-exercises-3.html"><a href="3.8-exercises-3.html"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-lrwor.html"><a href="4-lrwor.html"><i class="fa fa-check"></i><b>4</b> Linear Regression with One Regressor</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-simple-linear-regression.html"><a href="4.1-simple-linear-regression.html"><i class="fa fa-check"></i><b>4.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="4.2" data-path="4.2-estimating-the-coefficients-of-the-linear-regression-model.html"><a href="4.2-estimating-the-coefficients-of-the-linear-regression-model.html"><i class="fa fa-check"></i><b>4.2</b> Estimating the Coefficients of the Linear Regression Model</a>
<ul>
<li class="chapter" data-level="" data-path="4.2-estimating-the-coefficients-of-the-linear-regression-model.html"><a href="4.2-estimating-the-coefficients-of-the-linear-regression-model.html#the-ordinary-least-squares-estimator"><i class="fa fa-check"></i>The Ordinary Least Squares Estimator</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4.3-measures-of-fit.html"><a href="4.3-measures-of-fit.html"><i class="fa fa-check"></i><b>4.3</b> Measures of Fit</a>
<ul>
<li class="chapter" data-level="" data-path="4.3-measures-of-fit.html"><a href="4.3-measures-of-fit.html#the-coefficient-of-determination"><i class="fa fa-check"></i>The Coefficient of Determination</a></li>
<li class="chapter" data-level="" data-path="4.3-measures-of-fit.html"><a href="4.3-measures-of-fit.html#the-standard-error-of-the-regression"><i class="fa fa-check"></i>The Standard Error of the Regression</a></li>
<li class="chapter" data-level="" data-path="4.3-measures-of-fit.html"><a href="4.3-measures-of-fit.html#application-to-the-test-score-data"><i class="fa fa-check"></i>Application to the Test Score Data</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="4.4-tlsa.html"><a href="4.4-tlsa.html"><i class="fa fa-check"></i><b>4.4</b> The Least Squares Assumptions</a>
<ul>
<li class="chapter" data-level="" data-path="4.4-tlsa.html"><a href="4.4-tlsa.html#assumption-1-the-error-term-has-conditional-mean-of-zero"><i class="fa fa-check"></i>Assumption 1: The Error Term has Conditional Mean of Zero</a></li>
<li class="chapter" data-level="" data-path="4.4-tlsa.html"><a href="4.4-tlsa.html#assumption-2-independently-and-identically-distributed-data"><i class="fa fa-check"></i>Assumption 2: Independently and Identically Distributed Data</a></li>
<li class="chapter" data-level="" data-path="4.4-tlsa.html"><a href="4.4-tlsa.html#assumption-3-large-outliers-are-unlikely"><i class="fa fa-check"></i>Assumption 3: Large Outliers are Unlikely</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="4.5-tsdotoe.html"><a href="4.5-tsdotoe.html"><i class="fa fa-check"></i><b>4.5</b> The Sampling Distribution of the OLS Estimator</a>
<ul>
<li class="chapter" data-level="" data-path="4.5-tsdotoe.html"><a href="4.5-tsdotoe.html#simulation-study-1"><i class="fa fa-check"></i>Simulation Study 1</a></li>
<li class="chapter" data-level="" data-path="4.5-tsdotoe.html"><a href="4.5-tsdotoe.html#simulation-study-2"><i class="fa fa-check"></i>Simulation Study 2</a></li>
<li class="chapter" data-level="" data-path="4.5-tsdotoe.html"><a href="4.5-tsdotoe.html#simulation-study-3"><i class="fa fa-check"></i>Simulation Study 3</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="4.6-exercises-4.html"><a href="4.6-exercises-4.html"><i class="fa fa-check"></i><b>4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-htaciitslrm.html"><a href="5-htaciitslrm.html"><i class="fa fa-check"></i><b>5</b> Hypothesis Tests and Confidence Intervals in SLR Model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5.1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html"><a href="5.1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html"><i class="fa fa-check"></i><b>5.1</b> Testing Two-Sided Hypotheses concerning the Slope Coefficient</a></li>
<li class="chapter" data-level="5.2" data-path="5.2-cifrc.html"><a href="5.2-cifrc.html"><i class="fa fa-check"></i><b>5.2</b> Confidence Intervals for Regression Coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="5.2-cifrc.html"><a href="5.2-cifrc.html#simulation-study-confidence-intervals"><i class="fa fa-check"></i>Simulation Study: Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5.3-rwxiabv.html"><a href="5.3-rwxiabv.html"><i class="fa fa-check"></i><b>5.3</b> Regression when X is a Binary Variable</a></li>
<li class="chapter" data-level="5.4" data-path="5.4-hah.html"><a href="5.4-hah.html"><i class="fa fa-check"></i><b>5.4</b> Heteroskedasticity and Homoskedasticity</a>
<ul>
<li class="chapter" data-level="" data-path="5.4-hah.html"><a href="5.4-hah.html#a-real-world-example-for-heteroskedasticity"><i class="fa fa-check"></i>A Real-World Example for Heteroskedasticity</a></li>
<li class="chapter" data-level="" data-path="5.4-hah.html"><a href="5.4-hah.html#should-we-care-about-heteroskedasticity"><i class="fa fa-check"></i>Should We Care About Heteroskedasticity?</a></li>
<li class="chapter" data-level="" data-path="5.4-hah.html"><a href="5.4-hah.html#computation-of-heteroskedasticity-robust-standard-errors"><i class="fa fa-check"></i>Computation of Heteroskedasticity-Robust Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="5.5-the-gauss-markov-theorem.html"><a href="5.5-the-gauss-markov-theorem.html"><i class="fa fa-check"></i><b>5.5</b> The Gauss-Markov Theorem</a>
<ul>
<li class="chapter" data-level="" data-path="5.5-the-gauss-markov-theorem.html"><a href="5.5-the-gauss-markov-theorem.html#simulation-study-blue-estimator"><i class="fa fa-check"></i>Simulation Study: BLUE Estimator</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="5.6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html"><a href="5.6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html"><i class="fa fa-check"></i><b>5.6</b> Using the t-Statistic in Regression when the Sample Size Is Small</a></li>
<li class="chapter" data-level="5.7" data-path="5.7-exercises-5.html"><a href="5.7-exercises-5.html"><i class="fa fa-check"></i><b>5.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-rmwmr.html"><a href="6-rmwmr.html"><i class="fa fa-check"></i><b>6</b> Regression Models with Multiple Regressors</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6.1-omitted-variable-bias.html"><a href="6.1-omitted-variable-bias.html"><i class="fa fa-check"></i><b>6.1</b> Omitted Variable Bias</a></li>
<li class="chapter" data-level="6.2" data-path="6.2-tmrm.html"><a href="6.2-tmrm.html"><i class="fa fa-check"></i><b>6.2</b> The Multiple Regression Model</a></li>
<li class="chapter" data-level="6.3" data-path="6.3-mofimr.html"><a href="6.3-mofimr.html"><i class="fa fa-check"></i><b>6.3</b> Measures of Fit in Multiple Regression</a></li>
<li class="chapter" data-level="6.4" data-path="6.4-ols-assumptions-in-multiple-regression.html"><a href="6.4-ols-assumptions-in-multiple-regression.html"><i class="fa fa-check"></i><b>6.4</b> OLS Assumptions in Multiple Regression</a>
<ul>
<li class="chapter" data-level="" data-path="6.4-ols-assumptions-in-multiple-regression.html"><a href="6.4-ols-assumptions-in-multiple-regression.html#multicollinearity"><i class="fa fa-check"></i>Multicollinearity</a></li>
<li class="chapter" data-level="" data-path="6.4-ols-assumptions-in-multiple-regression.html"><a href="6.4-ols-assumptions-in-multiple-regression.html#simulation-study-imperfect-multicollinearity"><i class="fa fa-check"></i>Simulation Study: Imperfect Multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="6.5-the-distribution-of-the-ols-estimators-in-multiple-regression.html"><a href="6.5-the-distribution-of-the-ols-estimators-in-multiple-regression.html"><i class="fa fa-check"></i><b>6.5</b> The Distribution of the OLS Estimators in Multiple Regression</a></li>
<li class="chapter" data-level="6.6" data-path="6.6-exercises-6.html"><a href="6.6-exercises-6.html"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-htaciimr.html"><a href="7-htaciimr.html"><i class="fa fa-check"></i><b>7</b> Hypothesis Tests and Confidence Intervals in MR Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="7.1-hypothesis-tests-and-confidence-intervals-for-a-single-coefficient.html"><a href="7.1-hypothesis-tests-and-confidence-intervals-for-a-single-coefficient.html"><i class="fa fa-check"></i><b>7.1</b> Hypothesis Tests and Confidence Intervals for a Single Coefficient</a></li>
<li class="chapter" data-level="7.2" data-path="7.2-an-application-to-test-scores-and-the-student-teacher-ratio.html"><a href="7.2-an-application-to-test-scores-and-the-student-teacher-ratio.html"><i class="fa fa-check"></i><b>7.2</b> An Application to Test Scores and the Student-Teacher Ratio</a>
<ul>
<li class="chapter" data-level="" data-path="7.2-an-application-to-test-scores-and-the-student-teacher-ratio.html"><a href="7.2-an-application-to-test-scores-and-the-student-teacher-ratio.html#another-augmentation-of-the-model"><i class="fa fa-check"></i>Another Augmentation of the Model</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7.3-joint-hypothesis-testing-using-the-f-statistic.html"><a href="7.3-joint-hypothesis-testing-using-the-f-statistic.html"><i class="fa fa-check"></i><b>7.3</b> Joint Hypothesis Testing using the F-Statistic</a></li>
<li class="chapter" data-level="7.4" data-path="7.4-confidence-sets-for-multiple-coefficients.html"><a href="7.4-confidence-sets-for-multiple-coefficients.html"><i class="fa fa-check"></i><b>7.4</b> Confidence Sets for Multiple Coefficients</a></li>
<li class="chapter" data-level="7.5" data-path="7.5-model-specification-for-multiple-regression.html"><a href="7.5-model-specification-for-multiple-regression.html"><i class="fa fa-check"></i><b>7.5</b> Model Specification for Multiple Regression</a>
<ul>
<li class="chapter" data-level="" data-path="7.5-model-specification-for-multiple-regression.html"><a href="7.5-model-specification-for-multiple-regression.html#model-specification-in-theory-and-in-practice"><i class="fa fa-check"></i>Model Specification in Theory and in Practice</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="7.6-analysis-of-the-test-score-data-set.html"><a href="7.6-analysis-of-the-test-score-data-set.html"><i class="fa fa-check"></i><b>7.6</b> Analysis of the Test Score Data Set</a></li>
<li class="chapter" data-level="7.7" data-path="7.7-exercises-7.html"><a href="7.7-exercises-7.html"><i class="fa fa-check"></i><b>7.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-nrf.html"><a href="8-nrf.html"><i class="fa fa-check"></i><b>8</b> Nonlinear Regression Functions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8.1-a-general-strategy-for-modelling-nonlinear-regression-functions.html"><a href="8.1-a-general-strategy-for-modelling-nonlinear-regression-functions.html"><i class="fa fa-check"></i><b>8.1</b> A General Strategy for Modelling Nonlinear Regression Functions</a></li>
<li class="chapter" data-level="8.2" data-path="8.2-nfoasiv.html"><a href="8.2-nfoasiv.html"><i class="fa fa-check"></i><b>8.2</b> Nonlinear Functions of a Single Independent Variable</a>
<ul>
<li class="chapter" data-level="" data-path="8.2-nfoasiv.html"><a href="8.2-nfoasiv.html#polynomials"><i class="fa fa-check"></i>Polynomials</a></li>
<li class="chapter" data-level="" data-path="8.2-nfoasiv.html"><a href="8.2-nfoasiv.html#logarithms"><i class="fa fa-check"></i>Logarithms</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8.3-interactions-between-independent-variables.html"><a href="8.3-interactions-between-independent-variables.html"><i class="fa fa-check"></i><b>8.3</b> Interactions between Independent Variables</a></li>
<li class="chapter" data-level="8.4" data-path="8.4-nonlinear-effects-on-test-scores-of-the-student-teacher-ratio.html"><a href="8.4-nonlinear-effects-on-test-scores-of-the-student-teacher-ratio.html"><i class="fa fa-check"></i><b>8.4</b> Nonlinear Effects on Test Scores of the Student-Teacher Ratio</a></li>
<li class="chapter" data-level="8.5" data-path="8.5-exercises-8.html"><a href="8.5-exercises-8.html"><i class="fa fa-check"></i><b>8.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-asbomr.html"><a href="9-asbomr.html"><i class="fa fa-check"></i><b>9</b> Assessing Studies Based on Multiple Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="9.1-internal-and-external-validity.html"><a href="9.1-internal-and-external-validity.html"><i class="fa fa-check"></i><b>9.1</b> Internal and External Validity</a></li>
<li class="chapter" data-level="9.2" data-path="9.2-ttivomra.html"><a href="9.2-ttivomra.html"><i class="fa fa-check"></i><b>9.2</b> Threats to Internal Validity of Multiple Regression Analysis</a></li>
<li class="chapter" data-level="9.3" data-path="9.3-internal-and-external-validity-when-the-regression-is-used-for-forecasting.html"><a href="9.3-internal-and-external-validity-when-the-regression-is-used-for-forecasting.html"><i class="fa fa-check"></i><b>9.3</b> Internal and External Validity when the Regression is used for Forecasting</a></li>
<li class="chapter" data-level="9.4" data-path="9.4-etsacs.html"><a href="9.4-etsacs.html"><i class="fa fa-check"></i><b>9.4</b> Example: Test Scores and Class Size</a></li>
<li class="chapter" data-level="9.5" data-path="9.5-exercises-9.html"><a href="9.5-exercises-9.html"><i class="fa fa-check"></i><b>9.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-rwpd.html"><a href="10-rwpd.html"><i class="fa fa-check"></i><b>10</b> Regression with Panel Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="10.1-panel-data.html"><a href="10.1-panel-data.html"><i class="fa fa-check"></i><b>10.1</b> Panel Data</a></li>
<li class="chapter" data-level="10.2" data-path="10.2-PDWTTP.html"><a href="10.2-PDWTTP.html"><i class="fa fa-check"></i><b>10.2</b> Panel Data with Two Time Periods: “Before and After” Comparisons</a></li>
<li class="chapter" data-level="10.3" data-path="10.3-fixed-effects-regression.html"><a href="10.3-fixed-effects-regression.html"><i class="fa fa-check"></i><b>10.3</b> Fixed Effects Regression</a>
<ul>
<li class="chapter" data-level="" data-path="10.3-fixed-effects-regression.html"><a href="10.3-fixed-effects-regression.html#estimation-and-inference"><i class="fa fa-check"></i>Estimation and Inference</a></li>
<li class="chapter" data-level="" data-path="10.3-fixed-effects-regression.html"><a href="10.3-fixed-effects-regression.html#application-to-traffic-deaths"><i class="fa fa-check"></i>Application to Traffic Deaths</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="10.4-regression-with-time-fixed-effects.html"><a href="10.4-regression-with-time-fixed-effects.html"><i class="fa fa-check"></i><b>10.4</b> Regression with Time Fixed Effects</a></li>
<li class="chapter" data-level="10.5" data-path="10.5-tferaaseffer.html"><a href="10.5-tferaaseffer.html"><i class="fa fa-check"></i><b>10.5</b> The Fixed Effects Regression Assumptions and Standard Errors for Fixed Effects Regression</a></li>
<li class="chapter" data-level="10.6" data-path="10.6-drunk-driving-laws-and-traffic-deaths.html"><a href="10.6-drunk-driving-laws-and-traffic-deaths.html"><i class="fa fa-check"></i><b>10.6</b> Drunk Driving Laws and Traffic Deaths</a></li>
<li class="chapter" data-level="10.7" data-path="10.7-exercises-10.html"><a href="10.7-exercises-10.html"><i class="fa fa-check"></i><b>10.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-rwabdv.html"><a href="11-rwabdv.html"><i class="fa fa-check"></i><b>11</b> Regression with a Binary Dependent Variable</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11.1-binary-dependent-variables-and-the-linear-probability-model.html"><a href="11.1-binary-dependent-variables-and-the-linear-probability-model.html"><i class="fa fa-check"></i><b>11.1</b> Binary Dependent Variables and the Linear Probability Model</a></li>
<li class="chapter" data-level="11.2" data-path="11.2-palr.html"><a href="11.2-palr.html"><i class="fa fa-check"></i><b>11.2</b> Probit and Logit Regression</a>
<ul>
<li class="chapter" data-level="" data-path="11.2-palr.html"><a href="11.2-palr.html#probit-regression"><i class="fa fa-check"></i>Probit Regression</a></li>
<li class="chapter" data-level="" data-path="11.2-palr.html"><a href="11.2-palr.html#logit-regression"><i class="fa fa-check"></i>Logit Regression</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="11.3-estimation-and-inference-in-the-logit-and-probit-models.html"><a href="11.3-estimation-and-inference-in-the-logit-and-probit-models.html"><i class="fa fa-check"></i><b>11.3</b> Estimation and Inference in the Logit and Probit Models</a></li>
<li class="chapter" data-level="11.4" data-path="11.4-application-to-the-boston-hmda-data.html"><a href="11.4-application-to-the-boston-hmda-data.html"><i class="fa fa-check"></i><b>11.4</b> Application to the Boston HMDA Data</a></li>
<li class="chapter" data-level="11.5" data-path="11.5-exercises-11.html"><a href="11.5-exercises-11.html"><i class="fa fa-check"></i><b>11.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-ivr.html"><a href="12-ivr.html"><i class="fa fa-check"></i><b>12</b> Instrumental Variables Regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="12.1-TIVEWASRAASI.html"><a href="12.1-TIVEWASRAASI.html"><i class="fa fa-check"></i><b>12.1</b> The IV Estimator with a Single Regressor and a Single Instrument</a></li>
<li class="chapter" data-level="12.2" data-path="12.2-TGIVRM.html"><a href="12.2-TGIVRM.html"><i class="fa fa-check"></i><b>12.2</b> The General IV Regression Model</a></li>
<li class="chapter" data-level="12.3" data-path="12.3-civ.html"><a href="12.3-civ.html"><i class="fa fa-check"></i><b>12.3</b> Checking Instrument Validity</a></li>
<li class="chapter" data-level="12.4" data-path="12.4-attdfc.html"><a href="12.4-attdfc.html"><i class="fa fa-check"></i><b>12.4</b> Application to the Demand for Cigarettes</a></li>
<li class="chapter" data-level="12.5" data-path="12.5-where-do-valid-instruments-come-from.html"><a href="12.5-where-do-valid-instruments-come-from.html"><i class="fa fa-check"></i><b>12.5</b> Where Do Valid Instruments Come From?</a></li>
<li class="chapter" data-level="12.6" data-path="12.6-exercises-12.html"><a href="12.6-exercises-12.html"><i class="fa fa-check"></i><b>12.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-eaqe.html"><a href="13-eaqe.html"><i class="fa fa-check"></i><b>13</b> Experiments and Quasi-Experiments</a>
<ul>
<li class="chapter" data-level="13.1" data-path="13.1-poceaie.html"><a href="13.1-poceaie.html"><i class="fa fa-check"></i><b>13.1</b> Potential Outcomes, Causal Effects and Idealized Experiments</a></li>
<li class="chapter" data-level="13.2" data-path="13.2-threats-to-validity-of-experiments.html"><a href="13.2-threats-to-validity-of-experiments.html"><i class="fa fa-check"></i><b>13.2</b> Threats to Validity of Experiments</a></li>
<li class="chapter" data-level="13.3" data-path="13.3-experimental-estimates-of-the-effect-of-class-size-reductions.html"><a href="13.3-experimental-estimates-of-the-effect-of-class-size-reductions.html"><i class="fa fa-check"></i><b>13.3</b> Experimental Estimates of the Effect of Class Size Reductions</a>
<ul>
<li class="chapter" data-level="" data-path="13.3-experimental-estimates-of-the-effect-of-class-size-reductions.html"><a href="13.3-experimental-estimates-of-the-effect-of-class-size-reductions.html#experimental-design-and-the-data-set"><i class="fa fa-check"></i>Experimental Design and the Data Set</a></li>
<li class="chapter" data-level="" data-path="13.3-experimental-estimates-of-the-effect-of-class-size-reductions.html"><a href="13.3-experimental-estimates-of-the-effect-of-class-size-reductions.html#analysis-of-the-star-data"><i class="fa fa-check"></i>Analysis of the STAR Data</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="13.4-qe.html"><a href="13.4-qe.html"><i class="fa fa-check"></i><b>13.4</b> Quasi Experiments</a>
<ul>
<li class="chapter" data-level="" data-path="13.4-qe.html"><a href="13.4-qe.html#the-differences-in-differences-estimator"><i class="fa fa-check"></i>The Differences-in-Differences Estimator</a></li>
<li class="chapter" data-level="" data-path="13.4-qe.html"><a href="13.4-qe.html#regression-discontinuity-estimators"><i class="fa fa-check"></i>Regression Discontinuity Estimators</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="13.5-exercises-13.html"><a href="13.5-exercises-13.html"><i class="fa fa-check"></i><b>13.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="14-ittsraf.html"><a href="14-ittsraf.html"><i class="fa fa-check"></i><b>14</b> Introduction to Time Series Regression and Forecasting</a>
<ul>
<li class="chapter" data-level="14.1" data-path="14.1-using-regression-models-for-forecasting.html"><a href="14.1-using-regression-models-for-forecasting.html"><i class="fa fa-check"></i><b>14.1</b> Using Regression Models for Forecasting</a></li>
<li class="chapter" data-level="14.2" data-path="14.2-tsdasc.html"><a href="14.2-tsdasc.html"><i class="fa fa-check"></i><b>14.2</b> Time Series Data and Serial Correlation</a>
<ul>
<li class="chapter" data-level="" data-path="14.2-tsdasc.html"><a href="14.2-tsdasc.html#notation-lags-differences-logarithms-and-growth-rates"><i class="fa fa-check"></i>Notation, Lags, Differences, Logarithms and Growth Rates</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="14.3-autoregressions.html"><a href="14.3-autoregressions.html"><i class="fa fa-check"></i><b>14.3</b> Autoregressions</a>
<ul>
<li class="chapter" data-level="" data-path="14.3-autoregressions.html"><a href="14.3-autoregressions.html#autoregressive-models-of-order-p"><i class="fa fa-check"></i>Autoregressive Models of Order <span class="math inline">\(p\)</span></a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="14.4-cybtmpi.html"><a href="14.4-cybtmpi.html"><i class="fa fa-check"></i><b>14.4</b> Can You Beat the Market? (Part I)</a></li>
<li class="chapter" data-level="14.5" data-path="14.5-apatadlm.html"><a href="14.5-apatadlm.html"><i class="fa fa-check"></i><b>14.5</b> Additional Predictors and The ADL Model</a>
<ul>
<li class="chapter" data-level="" data-path="14.5-apatadlm.html"><a href="14.5-apatadlm.html#forecast-uncertainty-and-forecast-intervals"><i class="fa fa-check"></i>Forecast Uncertainty and Forecast Intervals</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="14.6-llsuic.html"><a href="14.6-llsuic.html"><i class="fa fa-check"></i><b>14.6</b> Lag Length Selection using Information Criteria</a></li>
<li class="chapter" data-level="14.7" data-path="14.7-nit.html"><a href="14.7-nit.html"><i class="fa fa-check"></i><b>14.7</b> Nonstationarity I: Trends</a></li>
<li class="chapter" data-level="14.8" data-path="14.8-niib.html"><a href="14.8-niib.html"><i class="fa fa-check"></i><b>14.8</b> Nonstationarity II: Breaks</a></li>
<li class="chapter" data-level="14.9" data-path="14.9-can-you-beat-the-market-part-ii.html"><a href="14.9-can-you-beat-the-market-part-ii.html"><i class="fa fa-check"></i><b>14.9</b> Can You Beat the Market? (Part II)</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="15-eodce.html"><a href="15-eodce.html"><i class="fa fa-check"></i><b>15</b> Estimation of Dynamic Causal Effects</a>
<ul>
<li class="chapter" data-level="15.1" data-path="15.1-the-orange-juice-data.html"><a href="15.1-the-orange-juice-data.html"><i class="fa fa-check"></i><b>15.1</b> The Orange Juice Data</a></li>
<li class="chapter" data-level="15.2" data-path="15.2-dynamic-causal-effects.html"><a href="15.2-dynamic-causal-effects.html"><i class="fa fa-check"></i><b>15.2</b> Dynamic Causal Effects</a></li>
<li class="chapter" data-level="15.3" data-path="15.3-dynamic-multipliers-and-cumulative-dynamic-multipliers.html"><a href="15.3-dynamic-multipliers-and-cumulative-dynamic-multipliers.html"><i class="fa fa-check"></i><b>15.3</b> Dynamic Multipliers and Cumulative Dynamic Multipliers</a></li>
<li class="chapter" data-level="15.4" data-path="15.4-hac-standard-errors.html"><a href="15.4-hac-standard-errors.html"><i class="fa fa-check"></i><b>15.4</b> HAC Standard Errors</a></li>
<li class="chapter" data-level="15.5" data-path="15.5-estimation-of-dynamic-causal-effects-with-strictly-exogeneous-regressors.html"><a href="15.5-estimation-of-dynamic-causal-effects-with-strictly-exogeneous-regressors.html"><i class="fa fa-check"></i><b>15.5</b> Estimation of Dynamic Causal Effects with Strictly Exogeneous Regressors</a></li>
<li class="chapter" data-level="15.6" data-path="15.6-orange-juice-prices-and-cold-weather.html"><a href="15.6-orange-juice-prices-and-cold-weather.html"><i class="fa fa-check"></i><b>15.6</b> Orange Juice Prices and Cold Weather</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="16-atitsr.html"><a href="16-atitsr.html"><i class="fa fa-check"></i><b>16</b> Additional Topics in Time Series Regression</a>
<ul>
<li class="chapter" data-level="16.1" data-path="16.1-vector-autoregressions.html"><a href="16.1-vector-autoregressions.html"><i class="fa fa-check"></i><b>16.1</b> Vector Autoregressions</a></li>
<li class="chapter" data-level="16.2" data-path="16.2-ooiatdfglsurt.html"><a href="16.2-ooiatdfglsurt.html"><i class="fa fa-check"></i><b>16.2</b> Orders of Integration and the DF-GLS Unit Root Test</a></li>
<li class="chapter" data-level="16.3" data-path="16.3-cointegration.html"><a href="16.3-cointegration.html"><i class="fa fa-check"></i><b>16.3</b> Cointegration</a></li>
<li class="chapter" data-level="16.4" data-path="16.4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><a href="16.4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><i class="fa fa-check"></i><b>16.4</b> Volatility Clustering and Autoregressive Conditional Heteroskedasticity</a>
<ul>
<li class="chapter" data-level="" data-path="16.4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><a href="16.4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html#arch-and-garch-models"><i class="fa fa-check"></i>ARCH and GARCH Models</a></li>
<li class="chapter" data-level="" data-path="16.4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><a href="16.4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html#application-to-stock-price-volatility"><i class="fa fa-check"></i>Application to Stock Price Volatility</a></li>
<li class="chapter" data-level="" data-path="16.4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><a href="16.4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html#summary-8"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Econometrics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b>Open Review</b>. We want your feedback to make the book better for you and other students. You may annotate some text by <span style="background-color: #3297FD; color: white">selecting it with the cursor</span> and then click "Annotate" in the pop-up menu. You can also see the annotations of others: click the arrow in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="ttivomra" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Threats to Internal Validity of Multiple Regression Analysis<a href="9.2-ttivomra.html#ttivomra" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section treats five sources that cause the OLS estimator in (multiple) regression models to be biased and inconsistent for the causal effect of interest and discusses possible remedies. All five sources imply a violation of the first least squares assumption presented in Key Concept 6.4.</p>
<p>This sections treats:</p>
<ul>
<li><p>omitted variable bias,</p></li>
<li><p>misspecification of the functional form,</p></li>
<li><p>measurement errors,</p></li>
<li><p>missing data and sample selection,</p></li>
<li><p>simultaneous causality bias.</p></li>
</ul>
<p>Beside these threats for consistency of the estimator, we also briefly discuss causes of inconsistent estimation of OLS standard errors.</p>
<div id="omitted-variable-bias-1" class="section level4 unnumbered hasAnchor">
<h4>Omitted Variable Bias<a href="9.2-ttivomra.html#omitted-variable-bias-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="KC9.2" class="keyconcept">
<h3 class="right">
Key Concept 9.2
</h3>
<h3 class="left">
Omitted Variable Bias: Should I include More Variables in My Regression?
</h3>
<p>Inclusion of additional variables reduces the risk of omitted variable bias but may increase the variance of the estimator of the coefficient of interest.</p>
<p>We present some guidelines that help deciding whether to include an additional variable:</p>
<ol style="list-style-type: decimal">
<li><p>Specify the coefficient(s) of interest.</p></li>
<li><p>Identify the most important potential sources of omitted variable bias by using knowledge available <em>before</em> estimating the model. You should end up with a baseline specification and a set of regressors that are questionable.</p></li>
<li><p>Use different model specifications to test whether questionable regressors have coefficients different from zero.</p></li>
<li><p>Use tables to provide full disclosure of your results, i.e., present different model specifications that both support your argument and enable the reader to see the effect of including questionable regressors.</p></li>
</ol>
</div>
<p>By now you should be aware of omitted variable bias and its consequences. Key Concept 9.2 gives some guidelines on how to proceed if there are control variables that possibly allow to reduce omitted variable bias. If including additional variables to mitigate the bias is not an option because there are no adequate controls, there are different approaches to solve the problem:</p>
<ul>
<li><p>usage of panel data methods (discussed in Chapter <a href="10-rwpd.html#rwpd">10</a>),</p></li>
<li><p>usage of instrumental variables regression (discussed in Chapter <a href="12-ivr.html#ivr">12</a>),</p></li>
<li><p>usage of a randomized control experiment (discussed in Chapter <a href="13-eaqe.html#eaqe">13</a>).</p></li>
</ul>
</div>
<div id="misspecification-of-the-functional-form-of-the-regression-function" class="section level4 unnumbered hasAnchor">
<h4>Misspecification of the Functional Form of the Regression Function<a href="9.2-ttivomra.html#misspecification-of-the-functional-form-of-the-regression-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If the population regression function is nonlinear but the regression function is linear, the functional form of the regression model is misspecified. This leads to a bias of the OLS estimator.</p>
<div id="KC9.3" class="keyconcept">
<h3 class="right">
Key Concept 9.3
</h3>
<h3 class="left">
Functional Form Misspecification
</h3>
<p>A regression suffers from misspecification of the functional form when the functional form of the estimated regression model differs from the functional form of the population regression function. Functional form misspecification leads to biased and inconsistent coefficient estimators. A way to detect functional form misspecification is to plot the estimated regression function and the data. This may also be helpful to choose the correct functional form.</p>
</div>
<p>It is easy to come up with examples of misspecification of the functional form: consider the case where the population regression function is <span class="math display">\[Y_i = X_i^2,\]</span> but the model used is <span class="math display">\[Y_i = \beta_0 + \beta_1 X_i + u_i.\]</span> Clearly, the regression function is misspecified here. We now simulate data and visualize this.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="9.2-ttivomra.html#cb216-1" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb216-2"><a href="9.2-ttivomra.html#cb216-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb216-3"><a href="9.2-ttivomra.html#cb216-3" tabindex="-1"></a></span>
<span id="cb216-4"><a href="9.2-ttivomra.html#cb216-4" tabindex="-1"></a><span class="co"># simulate data set</span></span>
<span id="cb216-5"><a href="9.2-ttivomra.html#cb216-5" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb216-6"><a href="9.2-ttivomra.html#cb216-6" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb216-7"><a href="9.2-ttivomra.html#cb216-7" tabindex="-1"></a></span>
<span id="cb216-8"><a href="9.2-ttivomra.html#cb216-8" tabindex="-1"></a><span class="co"># estimate the regression function</span></span>
<span id="cb216-9"><a href="9.2-ttivomra.html#cb216-9" tabindex="-1"></a>ms_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb216-10"><a href="9.2-ttivomra.html#cb216-10" tabindex="-1"></a>ms_mod</span>
<span id="cb216-11"><a href="9.2-ttivomra.html#cb216-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb216-12"><a href="9.2-ttivomra.html#cb216-12" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb216-13"><a href="9.2-ttivomra.html#cb216-13" tabindex="-1"></a><span class="co">#&gt; lm(formula = Y ~ X)</span></span>
<span id="cb216-14"><a href="9.2-ttivomra.html#cb216-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb216-15"><a href="9.2-ttivomra.html#cb216-15" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb216-16"><a href="9.2-ttivomra.html#cb216-16" tabindex="-1"></a><span class="co">#&gt; (Intercept)            X  </span></span>
<span id="cb216-17"><a href="9.2-ttivomra.html#cb216-17" tabindex="-1"></a><span class="co">#&gt;     8.11363     -0.04684</span></span></code></pre></div>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="9.2-ttivomra.html#cb217-1" tabindex="-1"></a><span class="co"># plot the data</span></span>
<span id="cb217-2"><a href="9.2-ttivomra.html#cb217-2" tabindex="-1"></a><span class="fu">plot</span>(X, Y, </span>
<span id="cb217-3"><a href="9.2-ttivomra.html#cb217-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Misspecification of Functional Form&quot;</span>,</span>
<span id="cb217-4"><a href="9.2-ttivomra.html#cb217-4" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb217-5"><a href="9.2-ttivomra.html#cb217-5" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb217-6"><a href="9.2-ttivomra.html#cb217-6" tabindex="-1"></a></span>
<span id="cb217-7"><a href="9.2-ttivomra.html#cb217-7" tabindex="-1"></a><span class="co"># plot the linear regression line</span></span>
<span id="cb217-8"><a href="9.2-ttivomra.html#cb217-8" tabindex="-1"></a><span class="fu">abline</span>(ms_mod, </span>
<span id="cb217-9"><a href="9.2-ttivomra.html#cb217-9" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb217-10"><a href="9.2-ttivomra.html#cb217-10" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb217-11"><a href="9.2-ttivomra.html#cb217-11" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>,</span>
<span id="cb217-12"><a href="9.2-ttivomra.html#cb217-12" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb217-13"><a href="9.2-ttivomra.html#cb217-13" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb217-14"><a href="9.2-ttivomra.html#cb217-14" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb217-15"><a href="9.2-ttivomra.html#cb217-15" tabindex="-1"></a>       <span class="at">col =</span><span class="st">&quot;red&quot;</span>, </span>
<span id="cb217-16"><a href="9.2-ttivomra.html#cb217-16" tabindex="-1"></a>       <span class="at">legend =</span> <span class="st">&quot;Linear Regression Line&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-381-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>It is evident that the regression errors are relatively small for observations close to <span class="math inline">\(X=-3\)</span> and <span class="math inline">\(X=3\)</span> but that the errors increase for <span class="math inline">\(X\)</span> values closer to zero and even more for values beyond <span class="math inline">\(-4\)</span> and <span class="math inline">\(4\)</span>. Consequences are drastic: the intercept is estimated to be <span class="math inline">\(8.1\)</span> and for the slope parameter, we obtain an estimate obviously very close to zero. This issue does not disappear as the number of observations is increased because OLS is biased <em>and</em> inconsistent due to the misspecification of the regression function.</p>
</div>
<div id="measurement-error-and-errors-in-variables-bias" class="section level4 unnumbered hasAnchor">
<h4>Measurement Error and Errors-in-Variables Bias<a href="9.2-ttivomra.html#measurement-error-and-errors-in-variables-bias" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="KC9.4" class="keyconcept">
<h3 class="right">
Key Concept 9.4
</h3>
<h3 class="left">
Errors-in-Variable Bias
</h3>
<p>When independent variables are measured imprecisely, we speak of errors-in-variables bias. This bias does not disappear if the sample size is large. If the measurement error has mean zero and is independent of the affected variable, the OLS estimator of the respective coefficient is biased towards zero.</p>
</div>
<p>Suppose you are incorrectly measuring the single regressor <span class="math inline">\(X_i\)</span> so that there is a measurement error and you observe <span class="math inline">\(\overset{\sim}{X}_i\)</span> instead of <span class="math inline">\(X_i\)</span>. Then, instead of estimating the regression model for the population, which is : <span class="math display">\[ Y_i = \beta_0 + \beta_1 X_i + u_i \]</span>, we end up estimating the regression model below:
<span class="math display">\[\begin{align*}
  Y_i =&amp; \, \beta_0 + \beta_1 \overset{\sim}{X}_i + \underbrace{\beta_1 (X_i - \overset{\sim}{X}_i) + u_i}_{=v_i}. \\
  Y_i =&amp; \, \beta_0 + \beta_1 \overset{\sim}{X}_i + v_i.
\end{align*}\]</span>
where <span class="math inline">\(\overset{\sim}{X}_i\)</span> and the error term <span class="math inline">\(v_i\)</span> are correlated. Thus OLS would be biased and inconsistent for the true <span class="math inline">\(\beta_1\)</span> in this example. One can show that direction and strength of the bias depend on the correlation between the observed regressor, <span class="math inline">\(\overset{\sim}{X}_i\)</span>, and the measurement error, <span class="math inline">\(w_i =X_i - \overset{\sim}{X}_i\)</span>. This correlation in turn depends on the type of the measurement error made.</p>
<p>The classical measurement error model assumes that the measurement error, <span class="math inline">\(w_i\)</span>, has zero mean and that it is uncorrelated with the variable, <span class="math inline">\(X_i\)</span>, and the error term of the population regression model, <span class="math inline">\(u_i\)</span>:</p>
<p><span class="math display">\[\begin{equation}
  \overset{\sim}{X}_i = X_i + w_i, \ \ \rho_{w_i,u_i}=0, \ \ \rho_{w_i,X_i}=0.
\end{equation}\]</span>
Then it holds that
<span class="math display" id="eq:cmembias">\[\begin{equation}
  \widehat{\beta}_1 \xrightarrow{p}{\frac{\sigma_{X}^2}{\sigma_{X}^2 + \sigma_{w}^2}} \beta_1, \tag{9.1}
\end{equation}\]</span></p>
<p>which implies inconsistency as <span class="math inline">\(\sigma_{X}^2, \sigma_{w}^2 &gt; 0\)</span> such that the fraction in <a href="9.2-ttivomra.html#eq:cmembias">(9.1)</a> is smaller than <span class="math inline">\(1\)</span>. Note that there are two extreme cases:</p>
<ol style="list-style-type: decimal">
<li><p>If there is no measurement error, <span class="math inline">\(\sigma_{w}^2=0\)</span> such that <span class="math inline">\(\widehat{\beta}_1 \xrightarrow{p}{\beta_1}\)</span>.</p></li>
<li><p>If <span class="math inline">\(\sigma_{w}^2 \gg \sigma_{X}^2\)</span> we have <span class="math inline">\(\widehat{\beta}_1 \xrightarrow{p}{0}\)</span>. This is the case if the measurement error is so large that there essentially is no information on <span class="math inline">\(X\)</span> in the data that can be used to estimate <span class="math inline">\(\beta_1\)</span>.</p></li>
</ol>
<p>The most obvious way to deal with errors-in-variables bias is to use an accurately measured <span class="math inline">\(X\)</span>. If this is not possible, instrumental variables regression is an option. One might also deal with the issue by using a mathematical model of the measurement error and adjust the estimates appropriately: if it is plausible that the classical measurement error model applies and if there is information that can be used to estimate the ratio in equation <a href="9.2-ttivomra.html#eq:cmembias">(9.1)</a>, one could compute an estimate that corrects for the downward bias.</p>
<p>For example, consider two bivariate normally distributed random variables <span class="math inline">\(X,Y\)</span>. It is a <a href="https://en.wikipedia.org/wiki/Multivariate_normal_distribution#Bivariate_case">well known result</a> that the conditional expectation function of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span> has the form
<span class="math display" id="eq:bnormexpfn">\[\begin{align}
  E(Y\vert X) = E(Y) + \rho_{X,Y} \frac{\sigma_{Y}}{\sigma_{X}}\left[X-E(X)\right]. \tag{9.2}
\end{align}\]</span> Thus for
<span class="math display" id="eq:bvnormd">\[\begin{align}
  (X, Y) \sim \mathcal{N}\left[\begin{pmatrix}50\\ 100\end{pmatrix},\begin{pmatrix}10 &amp; 5 \\ 5 &amp; 10 \end{pmatrix}\right] \tag{9.3}
\end{align}\]</span> according to <a href="9.2-ttivomra.html#eq:bnormexpfn">(9.2)</a>, the population regression function is
<span class="math display" id="eq:bnormregfun">\[\begin{align*}
  Y_i =&amp; \, 100 + 0.5 (X_i - 50) \\
      =&amp; \, 75 + 0.5 X_i. \tag{9.4}
\end{align*}\]</span>
Now suppose you gather data on <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, but that you can only measure <span class="math inline">\(\overset{\sim}{X_i} = X_i + w_i\)</span> with <span class="math inline">\(w_i \overset{i.i.d.}{\sim} \mathcal{N}(0,10)\)</span>. Since the <span class="math inline">\(w_i\)</span> are independent of the <span class="math inline">\(X_i\)</span>, there is no correlation between the <span class="math inline">\(X_i\)</span> and the <span class="math inline">\(w_i\)</span> so that we have a case of the classical measurement error model. We now illustrate this example in <tt>R</tt> using the package <tt>mvtnorm</tt> <span class="citation">(<a href="#ref-R-mvtnorm">Genz et al. 2025</a>)</span>.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="9.2-ttivomra.html#cb218-1" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb218-2"><a href="9.2-ttivomra.html#cb218-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb218-3"><a href="9.2-ttivomra.html#cb218-3" tabindex="-1"></a></span>
<span id="cb218-4"><a href="9.2-ttivomra.html#cb218-4" tabindex="-1"></a><span class="co"># load the package &#39;mvtnorm&#39; and simulate bivariate normal data</span></span>
<span id="cb218-5"><a href="9.2-ttivomra.html#cb218-5" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb218-6"><a href="9.2-ttivomra.html#cb218-6" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb218-7"><a href="9.2-ttivomra.html#cb218-7" tabindex="-1"></a>  <span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>), </span>
<span id="cb218-8"><a href="9.2-ttivomra.html#cb218-8" tabindex="-1"></a>          <span class="at">sigma =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>))))</span>
<span id="cb218-9"><a href="9.2-ttivomra.html#cb218-9" tabindex="-1"></a></span>
<span id="cb218-10"><a href="9.2-ttivomra.html#cb218-10" tabindex="-1"></a><span class="co"># set columns names</span></span>
<span id="cb218-11"><a href="9.2-ttivomra.html#cb218-11" tabindex="-1"></a><span class="fu">colnames</span>(dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p>We now estimate a simple linear regression of <span class="math inline">\(Y\)</span> on <span class="math inline">\(X\)</span> using this sample data and run the same regression again but this time we add i.i.d. <span class="math inline">\(\mathcal{N}(0,10)\)</span> errors added to <span class="math inline">\(X\)</span>.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="9.2-ttivomra.html#cb219-1" tabindex="-1"></a><span class="co"># estimate the model (without measurement error)</span></span>
<span id="cb219-2"><a href="9.2-ttivomra.html#cb219-2" tabindex="-1"></a>noerror_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> dat)</span>
<span id="cb219-3"><a href="9.2-ttivomra.html#cb219-3" tabindex="-1"></a></span>
<span id="cb219-4"><a href="9.2-ttivomra.html#cb219-4" tabindex="-1"></a><span class="co"># estimate the model (with measurement error in X)</span></span>
<span id="cb219-5"><a href="9.2-ttivomra.html#cb219-5" tabindex="-1"></a>dat<span class="sc">$</span>X <span class="ot">&lt;-</span> dat<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">10</span>))</span>
<span id="cb219-6"><a href="9.2-ttivomra.html#cb219-6" tabindex="-1"></a>error_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> dat)</span>
<span id="cb219-7"><a href="9.2-ttivomra.html#cb219-7" tabindex="-1"></a></span>
<span id="cb219-8"><a href="9.2-ttivomra.html#cb219-8" tabindex="-1"></a><span class="co"># print estimated coefficients to console</span></span>
<span id="cb219-9"><a href="9.2-ttivomra.html#cb219-9" tabindex="-1"></a>noerror_mod<span class="sc">$</span>coefficients</span>
<span id="cb219-10"><a href="9.2-ttivomra.html#cb219-10" tabindex="-1"></a><span class="co">#&gt; (Intercept)           X </span></span>
<span id="cb219-11"><a href="9.2-ttivomra.html#cb219-11" tabindex="-1"></a><span class="co">#&gt;  76.3002047   0.4755264</span></span>
<span id="cb219-12"><a href="9.2-ttivomra.html#cb219-12" tabindex="-1"></a>error_mod<span class="sc">$</span>coefficients</span>
<span id="cb219-13"><a href="9.2-ttivomra.html#cb219-13" tabindex="-1"></a><span class="co">#&gt; (Intercept)           X </span></span>
<span id="cb219-14"><a href="9.2-ttivomra.html#cb219-14" tabindex="-1"></a><span class="co">#&gt;   87.276004    0.255212</span></span></code></pre></div>
<p>Next, we visualize the results and compare with the population regression function.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="9.2-ttivomra.html#cb220-1" tabindex="-1"></a><span class="co"># plot sample data</span></span>
<span id="cb220-2"><a href="9.2-ttivomra.html#cb220-2" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>X, dat<span class="sc">$</span>Y, </span>
<span id="cb220-3"><a href="9.2-ttivomra.html#cb220-3" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb220-4"><a href="9.2-ttivomra.html#cb220-4" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb220-5"><a href="9.2-ttivomra.html#cb220-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb220-6"><a href="9.2-ttivomra.html#cb220-6" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb220-7"><a href="9.2-ttivomra.html#cb220-7" tabindex="-1"></a></span>
<span id="cb220-8"><a href="9.2-ttivomra.html#cb220-8" tabindex="-1"></a><span class="co"># add population regression function</span></span>
<span id="cb220-9"><a href="9.2-ttivomra.html#cb220-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="fl">0.5</span>), </span>
<span id="cb220-10"><a href="9.2-ttivomra.html#cb220-10" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb220-11"><a href="9.2-ttivomra.html#cb220-11" tabindex="-1"></a>       <span class="at">lwd  =</span> <span class="fl">1.5</span>)</span>
<span id="cb220-12"><a href="9.2-ttivomra.html#cb220-12" tabindex="-1"></a></span>
<span id="cb220-13"><a href="9.2-ttivomra.html#cb220-13" tabindex="-1"></a><span class="co"># add estimated regression functions</span></span>
<span id="cb220-14"><a href="9.2-ttivomra.html#cb220-14" tabindex="-1"></a><span class="fu">abline</span>(noerror_mod, </span>
<span id="cb220-15"><a href="9.2-ttivomra.html#cb220-15" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>,</span>
<span id="cb220-16"><a href="9.2-ttivomra.html#cb220-16" tabindex="-1"></a>       <span class="at">lwd  =</span> <span class="fl">1.5</span>)</span>
<span id="cb220-17"><a href="9.2-ttivomra.html#cb220-17" tabindex="-1"></a></span>
<span id="cb220-18"><a href="9.2-ttivomra.html#cb220-18" tabindex="-1"></a><span class="fu">abline</span>(error_mod, </span>
<span id="cb220-19"><a href="9.2-ttivomra.html#cb220-19" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>,</span>
<span id="cb220-20"><a href="9.2-ttivomra.html#cb220-20" tabindex="-1"></a>       <span class="at">lwd  =</span> <span class="fl">1.5</span>)</span>
<span id="cb220-21"><a href="9.2-ttivomra.html#cb220-21" tabindex="-1"></a></span>
<span id="cb220-22"><a href="9.2-ttivomra.html#cb220-22" tabindex="-1"></a><span class="co"># add legend</span></span>
<span id="cb220-23"><a href="9.2-ttivomra.html#cb220-23" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb220-24"><a href="9.2-ttivomra.html#cb220-24" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb220-25"><a href="9.2-ttivomra.html#cb220-25" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb220-26"><a href="9.2-ttivomra.html#cb220-26" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb220-27"><a href="9.2-ttivomra.html#cb220-27" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;darkred&quot;</span>), </span>
<span id="cb220-28"><a href="9.2-ttivomra.html#cb220-28" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Population&quot;</span>, <span class="st">&quot;No Errors&quot;</span>, <span class="st">&quot;Errors&quot;</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-386-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>In the situation without measurement error, the estimated regression function is close to the population regression function. Things are different when we use the mismeasured regressor <span class="math inline">\(X\)</span>: both the estimate for the intercept and the estimate for the coefficient on <span class="math inline">\(X\)</span> differ considerably from results obtained using the “clean” data on <span class="math inline">\(X\)</span>. In particular <span class="math inline">\(\widehat{\beta}_1 = 0.255\)</span>, so there is a downward bias. We are in the comfortable situation to know <span class="math inline">\(\sigma_X^2\)</span> and <span class="math inline">\(\sigma^2_w\)</span>. This allows us to correct for the bias using <a href="9.2-ttivomra.html#eq:cmembias">(9.1)</a>. Using this information we obtain the biased-corrected estimate <span class="math display">\[\frac{\sigma_X^2 + \sigma_w^2}{\sigma_X^2} \cdot \widehat{\beta}_1 = \frac{10+10}{10} \cdot 0.255 = 0.51\]</span> which is quite close to <span class="math inline">\(\beta_1=0.5\)</span>, the true coefficient from the population regression function.</p>
<p>Bear in mind that the above analysis uses a single sample. Thus one may argue that the results are just a coincidence. Can you show the contrary using a simulation study?</p>
</div>
<div id="missing-data-and-sample-selection" class="section level4 unnumbered hasAnchor">
<h4>Missing Data and Sample Selection<a href="9.2-ttivomra.html#missing-data-and-sample-selection" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="KC9.5" class="keyconcept">
<h3 class="right">
Key Concept 9.5
</h3>
<h3 class="left">
Sample Selection Bias
</h3>
<p>When the sampling process influences the availability of data and when there is a relation of this sampling process to the dependent variable that goes beyond the dependence on the regressors, we say that there is a sample selection bias. This bias is due to correlation between one or more regressors and the error term. Sample selection implies both bias and inconsistency of the OLS estimator.</p>
</div>
<p>There are three cases of sample selection. Only one of them poses a threat to internal validity of a regression study. The three cases are:</p>
<ol style="list-style-type: decimal">
<li><p>Data are missing at random.</p></li>
<li><p>Data are missing based on the value of a regressor.</p></li>
<li><p>Data are missing due to a selection process which is related to the dependent variable.</p></li>
</ol>
<p>Let us jump back to the example of variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> distributed as stated in equation <a href="9.2-ttivomra.html#eq:bvnormd">(9.3)</a> and illustrate all three cases using <tt>R</tt>.</p>
<p>If data are missing at random, this is nothing but losing the observations. For example, losing <span class="math inline">\(50\%\)</span> of the sample would be the same as never having seen the (randomly chosen) half of the sample observed. Therefore, missing data do not introduce an estimation bias and “only” lead to less efficient estimators.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="9.2-ttivomra.html#cb221-1" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb221-2"><a href="9.2-ttivomra.html#cb221-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb221-3"><a href="9.2-ttivomra.html#cb221-3" tabindex="-1"></a></span>
<span id="cb221-4"><a href="9.2-ttivomra.html#cb221-4" tabindex="-1"></a><span class="co"># simulate data</span></span>
<span id="cb221-5"><a href="9.2-ttivomra.html#cb221-5" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb221-6"><a href="9.2-ttivomra.html#cb221-6" tabindex="-1"></a>  <span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>), </span>
<span id="cb221-7"><a href="9.2-ttivomra.html#cb221-7" tabindex="-1"></a>          <span class="at">sigma =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>))))</span>
<span id="cb221-8"><a href="9.2-ttivomra.html#cb221-8" tabindex="-1"></a></span>
<span id="cb221-9"><a href="9.2-ttivomra.html#cb221-9" tabindex="-1"></a><span class="fu">colnames</span>(dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb221-10"><a href="9.2-ttivomra.html#cb221-10" tabindex="-1"></a></span>
<span id="cb221-11"><a href="9.2-ttivomra.html#cb221-11" tabindex="-1"></a><span class="co"># mark 500 randomly selected observations</span></span>
<span id="cb221-12"><a href="9.2-ttivomra.html#cb221-12" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">500</span>)</span>
<span id="cb221-13"><a href="9.2-ttivomra.html#cb221-13" tabindex="-1"></a></span>
<span id="cb221-14"><a href="9.2-ttivomra.html#cb221-14" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>X[<span class="sc">-</span>id], </span>
<span id="cb221-15"><a href="9.2-ttivomra.html#cb221-15" tabindex="-1"></a>     dat<span class="sc">$</span>Y[<span class="sc">-</span>id], </span>
<span id="cb221-16"><a href="9.2-ttivomra.html#cb221-16" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb221-17"><a href="9.2-ttivomra.html#cb221-17" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb221-18"><a href="9.2-ttivomra.html#cb221-18" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb221-19"><a href="9.2-ttivomra.html#cb221-19" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb221-20"><a href="9.2-ttivomra.html#cb221-20" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb221-21"><a href="9.2-ttivomra.html#cb221-21" tabindex="-1"></a></span>
<span id="cb221-22"><a href="9.2-ttivomra.html#cb221-22" tabindex="-1"></a><span class="fu">points</span>(dat<span class="sc">$</span>X[id], </span>
<span id="cb221-23"><a href="9.2-ttivomra.html#cb221-23" tabindex="-1"></a>       dat<span class="sc">$</span>Y[id],</span>
<span id="cb221-24"><a href="9.2-ttivomra.html#cb221-24" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb221-25"><a href="9.2-ttivomra.html#cb221-25" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, </span>
<span id="cb221-26"><a href="9.2-ttivomra.html#cb221-26" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb221-27"><a href="9.2-ttivomra.html#cb221-27" tabindex="-1"></a></span>
<span id="cb221-28"><a href="9.2-ttivomra.html#cb221-28" tabindex="-1"></a><span class="co"># add the population regression function</span></span>
<span id="cb221-29"><a href="9.2-ttivomra.html#cb221-29" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="fl">0.5</span>), </span>
<span id="cb221-30"><a href="9.2-ttivomra.html#cb221-30" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb221-31"><a href="9.2-ttivomra.html#cb221-31" tabindex="-1"></a>       <span class="at">lwd  =</span> <span class="fl">1.5</span>)</span>
<span id="cb221-32"><a href="9.2-ttivomra.html#cb221-32" tabindex="-1"></a></span>
<span id="cb221-33"><a href="9.2-ttivomra.html#cb221-33" tabindex="-1"></a><span class="co"># add the estimated regression function for the full sample</span></span>
<span id="cb221-34"><a href="9.2-ttivomra.html#cb221-34" tabindex="-1"></a><span class="fu">abline</span>(noerror_mod)</span>
<span id="cb221-35"><a href="9.2-ttivomra.html#cb221-35" tabindex="-1"></a></span>
<span id="cb221-36"><a href="9.2-ttivomra.html#cb221-36" tabindex="-1"></a><span class="co"># estimate model case 1 and add the regression line</span></span>
<span id="cb221-37"><a href="9.2-ttivomra.html#cb221-37" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[<span class="sc">-</span>id, ]</span>
<span id="cb221-38"><a href="9.2-ttivomra.html#cb221-38" tabindex="-1"></a></span>
<span id="cb221-39"><a href="9.2-ttivomra.html#cb221-39" tabindex="-1"></a>c1_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(dat<span class="sc">$</span>Y <span class="sc">~</span> dat<span class="sc">$</span>X, <span class="at">data =</span> dat)</span>
<span id="cb221-40"><a href="9.2-ttivomra.html#cb221-40" tabindex="-1"></a><span class="fu">abline</span>(c1_mod, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb221-41"><a href="9.2-ttivomra.html#cb221-41" tabindex="-1"></a></span>
<span id="cb221-42"><a href="9.2-ttivomra.html#cb221-42" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb221-43"><a href="9.2-ttivomra.html#cb221-43" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>,</span>
<span id="cb221-44"><a href="9.2-ttivomra.html#cb221-44" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb221-45"><a href="9.2-ttivomra.html#cb221-45" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb221-46"><a href="9.2-ttivomra.html#cb221-46" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb221-47"><a href="9.2-ttivomra.html#cb221-47" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;purple&quot;</span>), </span>
<span id="cb221-48"><a href="9.2-ttivomra.html#cb221-48" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Population&quot;</span>, <span class="st">&quot;Full sample&quot;</span>, <span class="st">&quot;500 obs. randomly selected&quot;</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-389-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The gray dots represent the <span class="math inline">\(500\)</span> discarded observations. When using the remaining observations, the estimation results deviate only marginally from the results obtained using the full sample.</p>
<p>Selecting data randomly based on the value of a regressor has also the effect of reducing the sample size and does not introduce estimation bias. We will now drop all observations with <span class="math inline">\(X &gt; 45\)</span>, estimate the model again and compare.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="9.2-ttivomra.html#cb222-1" tabindex="-1"></a><span class="co"># set random seed</span></span>
<span id="cb222-2"><a href="9.2-ttivomra.html#cb222-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb222-3"><a href="9.2-ttivomra.html#cb222-3" tabindex="-1"></a></span>
<span id="cb222-4"><a href="9.2-ttivomra.html#cb222-4" tabindex="-1"></a><span class="co"># simulate data</span></span>
<span id="cb222-5"><a href="9.2-ttivomra.html#cb222-5" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb222-6"><a href="9.2-ttivomra.html#cb222-6" tabindex="-1"></a>  <span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>), </span>
<span id="cb222-7"><a href="9.2-ttivomra.html#cb222-7" tabindex="-1"></a>          <span class="at">sigma =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>))))</span>
<span id="cb222-8"><a href="9.2-ttivomra.html#cb222-8" tabindex="-1"></a></span>
<span id="cb222-9"><a href="9.2-ttivomra.html#cb222-9" tabindex="-1"></a><span class="fu">colnames</span>(dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb222-10"><a href="9.2-ttivomra.html#cb222-10" tabindex="-1"></a></span>
<span id="cb222-11"><a href="9.2-ttivomra.html#cb222-11" tabindex="-1"></a><span class="co"># mark observations</span></span>
<span id="cb222-12"><a href="9.2-ttivomra.html#cb222-12" tabindex="-1"></a>id <span class="ot">&lt;-</span> dat<span class="sc">$</span>X <span class="sc">&gt;=</span> <span class="dv">45</span></span>
<span id="cb222-13"><a href="9.2-ttivomra.html#cb222-13" tabindex="-1"></a></span>
<span id="cb222-14"><a href="9.2-ttivomra.html#cb222-14" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>X[<span class="sc">-</span>id], </span>
<span id="cb222-15"><a href="9.2-ttivomra.html#cb222-15" tabindex="-1"></a>     dat<span class="sc">$</span>Y[<span class="sc">-</span>id], </span>
<span id="cb222-16"><a href="9.2-ttivomra.html#cb222-16" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb222-17"><a href="9.2-ttivomra.html#cb222-17" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb222-18"><a href="9.2-ttivomra.html#cb222-18" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb222-19"><a href="9.2-ttivomra.html#cb222-19" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb222-20"><a href="9.2-ttivomra.html#cb222-20" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb222-21"><a href="9.2-ttivomra.html#cb222-21" tabindex="-1"></a></span>
<span id="cb222-22"><a href="9.2-ttivomra.html#cb222-22" tabindex="-1"></a><span class="fu">points</span>(dat<span class="sc">$</span>X[id], </span>
<span id="cb222-23"><a href="9.2-ttivomra.html#cb222-23" tabindex="-1"></a>       dat<span class="sc">$</span>Y[id], </span>
<span id="cb222-24"><a href="9.2-ttivomra.html#cb222-24" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb222-25"><a href="9.2-ttivomra.html#cb222-25" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb222-26"><a href="9.2-ttivomra.html#cb222-26" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb222-27"><a href="9.2-ttivomra.html#cb222-27" tabindex="-1"></a></span>
<span id="cb222-28"><a href="9.2-ttivomra.html#cb222-28" tabindex="-1"></a><span class="co"># add population regression function</span></span>
<span id="cb222-29"><a href="9.2-ttivomra.html#cb222-29" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="fl">0.5</span>), </span>
<span id="cb222-30"><a href="9.2-ttivomra.html#cb222-30" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb222-31"><a href="9.2-ttivomra.html#cb222-31" tabindex="-1"></a>       <span class="at">lwd  =</span> <span class="fl">1.5</span>)</span>
<span id="cb222-32"><a href="9.2-ttivomra.html#cb222-32" tabindex="-1"></a></span>
<span id="cb222-33"><a href="9.2-ttivomra.html#cb222-33" tabindex="-1"></a><span class="co"># add estimated regression function for full sample</span></span>
<span id="cb222-34"><a href="9.2-ttivomra.html#cb222-34" tabindex="-1"></a><span class="fu">abline</span>(noerror_mod)</span>
<span id="cb222-35"><a href="9.2-ttivomra.html#cb222-35" tabindex="-1"></a></span>
<span id="cb222-36"><a href="9.2-ttivomra.html#cb222-36" tabindex="-1"></a><span class="co"># estimate model case 1, add regression line</span></span>
<span id="cb222-37"><a href="9.2-ttivomra.html#cb222-37" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">which</span>(dat<span class="sc">$</span>X <span class="sc">&gt;=</span> <span class="dv">45</span>)</span>
<span id="cb222-38"><a href="9.2-ttivomra.html#cb222-38" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[<span class="sc">-</span>id, ]</span>
<span id="cb222-39"><a href="9.2-ttivomra.html#cb222-39" tabindex="-1"></a></span>
<span id="cb222-40"><a href="9.2-ttivomra.html#cb222-40" tabindex="-1"></a>c2_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(dat<span class="sc">$</span>Y <span class="sc">~</span> dat<span class="sc">$</span>X, <span class="at">data =</span> dat)</span>
<span id="cb222-41"><a href="9.2-ttivomra.html#cb222-41" tabindex="-1"></a><span class="fu">abline</span>(c2_mod, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb222-42"><a href="9.2-ttivomra.html#cb222-42" tabindex="-1"></a></span>
<span id="cb222-43"><a href="9.2-ttivomra.html#cb222-43" tabindex="-1"></a><span class="co"># add legend</span></span>
<span id="cb222-44"><a href="9.2-ttivomra.html#cb222-44" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb222-45"><a href="9.2-ttivomra.html#cb222-45" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb222-46"><a href="9.2-ttivomra.html#cb222-46" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb222-47"><a href="9.2-ttivomra.html#cb222-47" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb222-48"><a href="9.2-ttivomra.html#cb222-48" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;purple&quot;</span>), </span>
<span id="cb222-49"><a href="9.2-ttivomra.html#cb222-49" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Population&quot;</span>, <span class="st">&quot;Full sample&quot;</span>,<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Obs.with &quot;</span>,</span>
<span id="cb222-50"><a href="9.2-ttivomra.html#cb222-50" tabindex="-1"></a>                                                               X <span class="sc">&lt;=</span> <span class="dv">45</span>))))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-390-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Note that although we dropped more than <span class="math inline">\(90\%\)</span> of all observations, the estimated regression function is very close to the line estimated based on the full sample.</p>
<p>In the third case we face sample selection bias. We can illustrate this by using only observations with <span class="math inline">\(X_i&lt;55\)</span> and <span class="math inline">\(Y_i&gt;100\)</span>. These observations are easily identified using the function <tt>which()</tt> and logical operators: <code>which(dat$X &lt; 55 &amp; dat$Y &gt; 100)</code>.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="9.2-ttivomra.html#cb223-1" tabindex="-1"></a><span class="co"># set random seed</span></span>
<span id="cb223-2"><a href="9.2-ttivomra.html#cb223-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb223-3"><a href="9.2-ttivomra.html#cb223-3" tabindex="-1"></a></span>
<span id="cb223-4"><a href="9.2-ttivomra.html#cb223-4" tabindex="-1"></a><span class="co"># simulate data</span></span>
<span id="cb223-5"><a href="9.2-ttivomra.html#cb223-5" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb223-6"><a href="9.2-ttivomra.html#cb223-6" tabindex="-1"></a>  <span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">100</span>), </span>
<span id="cb223-7"><a href="9.2-ttivomra.html#cb223-7" tabindex="-1"></a>          <span class="at">sigma =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>))))</span>
<span id="cb223-8"><a href="9.2-ttivomra.html#cb223-8" tabindex="-1"></a></span>
<span id="cb223-9"><a href="9.2-ttivomra.html#cb223-9" tabindex="-1"></a><span class="fu">colnames</span>(dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>,<span class="st">&quot;Y&quot;</span>)</span>
<span id="cb223-10"><a href="9.2-ttivomra.html#cb223-10" tabindex="-1"></a></span>
<span id="cb223-11"><a href="9.2-ttivomra.html#cb223-11" tabindex="-1"></a><span class="co"># mark observations</span></span>
<span id="cb223-12"><a href="9.2-ttivomra.html#cb223-12" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">which</span>(dat<span class="sc">$</span>X <span class="sc">&lt;=</span> <span class="dv">55</span> <span class="sc">&amp;</span> dat<span class="sc">$</span>Y <span class="sc">&gt;=</span> <span class="dv">100</span>)</span>
<span id="cb223-13"><a href="9.2-ttivomra.html#cb223-13" tabindex="-1"></a></span>
<span id="cb223-14"><a href="9.2-ttivomra.html#cb223-14" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>X[<span class="sc">-</span>id], </span>
<span id="cb223-15"><a href="9.2-ttivomra.html#cb223-15" tabindex="-1"></a>       dat<span class="sc">$</span>Y[<span class="sc">-</span>id], </span>
<span id="cb223-16"><a href="9.2-ttivomra.html#cb223-16" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb223-17"><a href="9.2-ttivomra.html#cb223-17" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb223-18"><a href="9.2-ttivomra.html#cb223-18" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb223-19"><a href="9.2-ttivomra.html#cb223-19" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb223-20"><a href="9.2-ttivomra.html#cb223-20" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb223-21"><a href="9.2-ttivomra.html#cb223-21" tabindex="-1"></a></span>
<span id="cb223-22"><a href="9.2-ttivomra.html#cb223-22" tabindex="-1"></a><span class="fu">points</span>(dat<span class="sc">$</span>X[id], </span>
<span id="cb223-23"><a href="9.2-ttivomra.html#cb223-23" tabindex="-1"></a>     dat<span class="sc">$</span>Y[id], </span>
<span id="cb223-24"><a href="9.2-ttivomra.html#cb223-24" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb223-25"><a href="9.2-ttivomra.html#cb223-25" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb223-26"><a href="9.2-ttivomra.html#cb223-26" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb223-27"><a href="9.2-ttivomra.html#cb223-27" tabindex="-1"></a></span>
<span id="cb223-28"><a href="9.2-ttivomra.html#cb223-28" tabindex="-1"></a><span class="co"># add population regression function</span></span>
<span id="cb223-29"><a href="9.2-ttivomra.html#cb223-29" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="fl">0.5</span>), </span>
<span id="cb223-30"><a href="9.2-ttivomra.html#cb223-30" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb223-31"><a href="9.2-ttivomra.html#cb223-31" tabindex="-1"></a>       <span class="at">lwd  =</span> <span class="fl">1.5</span>)</span>
<span id="cb223-32"><a href="9.2-ttivomra.html#cb223-32" tabindex="-1"></a></span>
<span id="cb223-33"><a href="9.2-ttivomra.html#cb223-33" tabindex="-1"></a><span class="co"># add estimated regression function for full sample</span></span>
<span id="cb223-34"><a href="9.2-ttivomra.html#cb223-34" tabindex="-1"></a><span class="fu">abline</span>(noerror_mod)</span>
<span id="cb223-35"><a href="9.2-ttivomra.html#cb223-35" tabindex="-1"></a></span>
<span id="cb223-36"><a href="9.2-ttivomra.html#cb223-36" tabindex="-1"></a><span class="co"># estimate model case 1, add regression line</span></span>
<span id="cb223-37"><a href="9.2-ttivomra.html#cb223-37" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[id, ]</span>
<span id="cb223-38"><a href="9.2-ttivomra.html#cb223-38" tabindex="-1"></a></span>
<span id="cb223-39"><a href="9.2-ttivomra.html#cb223-39" tabindex="-1"></a>c3_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(dat<span class="sc">$</span>Y <span class="sc">~</span> dat<span class="sc">$</span>X, <span class="at">data =</span> dat)</span>
<span id="cb223-40"><a href="9.2-ttivomra.html#cb223-40" tabindex="-1"></a><span class="fu">abline</span>(c3_mod, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb223-41"><a href="9.2-ttivomra.html#cb223-41" tabindex="-1"></a></span>
<span id="cb223-42"><a href="9.2-ttivomra.html#cb223-42" tabindex="-1"></a><span class="co"># add legend</span></span>
<span id="cb223-43"><a href="9.2-ttivomra.html#cb223-43" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>,</span>
<span id="cb223-44"><a href="9.2-ttivomra.html#cb223-44" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb223-45"><a href="9.2-ttivomra.html#cb223-45" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb223-46"><a href="9.2-ttivomra.html#cb223-46" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb223-47"><a href="9.2-ttivomra.html#cb223-47" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;purple&quot;</span>), </span>
<span id="cb223-48"><a href="9.2-ttivomra.html#cb223-48" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Population&quot;</span>, <span class="st">&quot;Full sample&quot;</span>,<span class="fu">expression</span>(<span class="fu">paste</span>(X <span class="sc">&lt;=</span> <span class="dv">55</span>,<span class="st">&quot;&amp;&quot;</span>,</span>
<span id="cb223-49"><a href="9.2-ttivomra.html#cb223-49" tabindex="-1"></a>                                                               Y <span class="sc">&gt;=</span> <span class="dv">100</span>))))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-391-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We see that the selection process leads to biased estimation results.</p>
<p>There are methods that allow to correct for sample selection bias. However, these methods are beyond the scope of the book and are therefore not considered here. The concept of sample selection bias is summarized in Key Concept 9.5.</p>
</div>
<div id="simultaneous-causality" class="section level4 unnumbered hasAnchor">
<h4>Simultaneous Causality<a href="9.2-ttivomra.html#simultaneous-causality" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="KC9.6" class="keyconcept">
<h3 class="right">
Key Concept 9.6
</h3>
<h3 class="left">
Simultaneous Causality Bias
</h3>
<p>So far we have assumed that the changes in the independent variable <span class="math inline">\(X\)</span> are responsible for the changes in the dependent variable <span class="math inline">\(Y\)</span>. When the reverse is also true, we say that there is <em>simultaneous causality</em> between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. This reverse causality leads to correlation between <span class="math inline">\(X\)</span> and the error in the population regression of interest such that the coefficient on <span class="math inline">\(X\)</span> is estimated with bias.</p>
</div>
<p>Suppose we are interested in estimating the effect of a <span class="math inline">\(20\%\)</span> increase in cigarette prices on cigarette consumption in the United States using a multiple regression model. This may be investigated using the dataset <tt>CigarettesSW</tt> which is a part of the <tt>AER</tt> package. <tt>CigarettesSW</tt> is a panel data set on cigarette consumption for all 48 continental U.S. federal states from 1985-1995 and provides data on economic indicators and average local prices, taxes and per capita pack consumption.</p>
<p>After loading the data set, we pick observations for the year 1995 and plot logarithms of the per pack price, <tt>price</tt>, against pack consumption, <tt>packs</tt>, and estimate a simple linear regression model.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="9.2-ttivomra.html#cb224-1" tabindex="-1"></a><span class="co"># load the data set</span></span>
<span id="cb224-2"><a href="9.2-ttivomra.html#cb224-2" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb224-3"><a href="9.2-ttivomra.html#cb224-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CigarettesSW&quot;</span>)</span>
<span id="cb224-4"><a href="9.2-ttivomra.html#cb224-4" tabindex="-1"></a>c1995 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">&quot;1995&quot;</span>)</span>
<span id="cb224-5"><a href="9.2-ttivomra.html#cb224-5" tabindex="-1"></a></span>
<span id="cb224-6"><a href="9.2-ttivomra.html#cb224-6" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb224-7"><a href="9.2-ttivomra.html#cb224-7" tabindex="-1"></a>cigcon_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(packs) <span class="sc">~</span> <span class="fu">log</span>(price), <span class="at">data =</span> c1995)</span>
<span id="cb224-8"><a href="9.2-ttivomra.html#cb224-8" tabindex="-1"></a>cigcon_mod</span>
<span id="cb224-9"><a href="9.2-ttivomra.html#cb224-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb224-10"><a href="9.2-ttivomra.html#cb224-10" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb224-11"><a href="9.2-ttivomra.html#cb224-11" tabindex="-1"></a><span class="co">#&gt; lm(formula = log(packs) ~ log(price), data = c1995)</span></span>
<span id="cb224-12"><a href="9.2-ttivomra.html#cb224-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb224-13"><a href="9.2-ttivomra.html#cb224-13" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb224-14"><a href="9.2-ttivomra.html#cb224-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)   log(price)  </span></span>
<span id="cb224-15"><a href="9.2-ttivomra.html#cb224-15" tabindex="-1"></a><span class="co">#&gt;      10.850       -1.213</span></span></code></pre></div>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="9.2-ttivomra.html#cb225-1" tabindex="-1"></a><span class="co"># plot the estimated regression line and the data</span></span>
<span id="cb225-2"><a href="9.2-ttivomra.html#cb225-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(c1995<span class="sc">$</span>price), <span class="fu">log</span>(c1995<span class="sc">$</span>packs),</span>
<span id="cb225-3"><a href="9.2-ttivomra.html#cb225-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;ln(Price)&quot;</span>,</span>
<span id="cb225-4"><a href="9.2-ttivomra.html#cb225-4" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;ln(Consumption)&quot;</span>,</span>
<span id="cb225-5"><a href="9.2-ttivomra.html#cb225-5" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Demand for Cigarettes&quot;</span>,</span>
<span id="cb225-6"><a href="9.2-ttivomra.html#cb225-6" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb225-7"><a href="9.2-ttivomra.html#cb225-7" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb225-8"><a href="9.2-ttivomra.html#cb225-8" tabindex="-1"></a></span>
<span id="cb225-9"><a href="9.2-ttivomra.html#cb225-9" tabindex="-1"></a><span class="fu">abline</span>(cigcon_mod, </span>
<span id="cb225-10"><a href="9.2-ttivomra.html#cb225-10" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>, </span>
<span id="cb225-11"><a href="9.2-ttivomra.html#cb225-11" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb225-12"><a href="9.2-ttivomra.html#cb225-12" tabindex="-1"></a><span class="co"># add legend</span></span>
<span id="cb225-13"><a href="9.2-ttivomra.html#cb225-13" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span> <span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;Estimated Regression Line&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-395-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Remember from Chapter <a href="8-nrf.html#nrf">8</a> that, due to the log-log specification, in the population regression the coefficient on the logarithm of price is interpreted as the price elasticity of consumption. The estimated coefficient suggests that a <span class="math inline">\(1\%\)</span> increase in cigarette prices reduces cigarette consumption by about <span class="math inline">\(1.2\%\)</span>, on average. Have we estimated a demand curve? The answer is no: this is a classic example of simultaneous causality, see Key Concept 9.6. The observations are market equilibrium which are determined by both changes in supply and changes in demand. Therefore the price is correlated with the error term and the OLS estimator is biased. We can neither estimate a demand nor a supply curve consistently using this approach.</p>
<p>We will return to this issue in Chapter <a href="12-ivr.html#ivr">12</a> which treats instrumental variables regression, an approach that allows consistent estimation when there is simultaneous causality.</p>
</div>
<div id="sources-of-inconsistency-of-ols-standard-errors" class="section level4 unnumbered hasAnchor">
<h4>Sources of Inconsistency of OLS Standard Errors<a href="9.2-ttivomra.html#sources-of-inconsistency-of-ols-standard-errors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are two central threats to computation of consistent OLS standard errors:</p>
<ol style="list-style-type: decimal">
<li><p>Heteroskedasticity: implications of heteroskedasticiy have been discussed in Chapter <a href="5-htaciitslrm.html#htaciitslrm">5</a>. Heteroskedasticity-robust standard errors as computed by the function <tt>vcovHC()</tt> from the package <tt>sandwich</tt> produce valid standard errors under heteroskedasticity.</p></li>
<li><p>Serial correlation: if the population regression error is correlated across observations, we have serial correlation. This often happens in applications where repeated observations are used, e.g., in panel data studies. As for heteroskedasticity, <tt>vcovHC()</tt> can be used to obtain valid standard errors when there is serial correlation.</p></li>
</ol>
<p>Inconsistent standard errors will produce invalid hypothesis tests and wrong confidence intervals. For example, when testing the null that some model coefficient is zero, we cannot trust the outcome anymore because the test may fail to have a size of <span class="math inline">\(5\%\)</span> due to the wrongly computed standard error.</p>
<p>Key Concept 9.7 summarizes all threats to internal validity discussed above.</p>
<div id="KC9.7" class="keyconcept">
<h3 class="right">
Key Concept 9.7
</h3>
<h3 class="left">
Threats to Internal Validity of a Regression Study
</h3>
<p>The five primary threats to internal validity of a multiple regression study are:</p>
<ol style="list-style-type: decimal">
<li><p>Omitted variables.</p></li>
<li><p>Misspecification of functional form.</p></li>
<li><p>Errors in variables (measurement errors in the regressors).</p></li>
<li><p>Sample selection.</p></li>
<li><p>Simultaneous causality.</p></li>
</ol>
<p>All these threats lead to failure of the first least squares assumption <span class="math display">\[E(u_i\vert X_{1i},\dots ,X_{ki}) \neq 0,\]</span> so that the OLS estimator is biased <em>and</em> inconsistent. <br></p>
<p>Furthermore, if one does not adjust for heteroskedasticity <em>and</em>/<em>or</em> serial correlation, incorrect standard errors may be a threat to internal validity of the study.</p>
</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-R-mvtnorm" class="csl-entry">
Genz, Alan, Frank Bretz, Tetsuhisa Miwa, Xuefei Mi, and Torsten Hothorn. 2025. <em><span class="nocase">mvtnorm: Multivariate Normal and t Distributions</span></em> (version 1.3-3). <a href="http://mvtnorm.R-forge.R-project.org">http://mvtnorm.R-forge.R-project.org</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="9.1-internal-and-external-validity.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="9.3-internal-and-external-validity-when-the-regression-is-used-for-forecasting.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": true,
    "twitter": true,
    "linkedin": true,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "serif",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/mca91/EconometricsWithR/edit/master/09-ch9.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["ITER.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection",
    "scroll_highlight": true
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
