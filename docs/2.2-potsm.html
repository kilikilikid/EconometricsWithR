<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>2.2 Properties of the Sample Mean | Introduction to Econometrics with R</title>
<meta name="description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
<meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

<meta property="og:title" content="2.2 Properties of the Sample Mean | Introduction to Econometrics with R" />
<meta property="og:type" content="book" />
<meta property="og:image" content="https://www.econometrics-with-r.org//images/cover.png" />
<meta property="og:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
<meta name="github-repo" content="mca91/EconometricsWithR" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="2.2 Properties of the Sample Mean | Introduction to Econometrics with R" />

<meta name="twitter:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
<meta name="twitter:image" content="https://www.econometrics-with-r.org//images/cover.png" />

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber, and Martin Schmelzer" />


<meta name="date" content="2023-07-12" />

<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />


<link rel="prev" href="2.1-estimation-of-the-population-mean.html"/>
<link rel="next" href="2.3-hypothesis-tests-concerning-the-population-mean.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- font families -->

<link href="https://fonts.googleapis.com/css?family=PT+Sans|Pacifico|Source+Sans+Pro" rel="stylesheet">

<script src="js/hideOutput.js"></script>

<!-- Mathjax -->
<script type="text/javascript" id="MathJax-script" async
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/mml-chtml.min.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
extensions: ["tex2jax.js", "TeX/AMSmath.js"],
tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
jax: ["input/TeX","output/CommonHTML"]
});
MathJax.Hub.processSectionDelay = 0;
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-110299877-1');
</script>

<!-- open review block -->

<script type="application/json" class="js-hypothesis-config">
{
"showHighlights": false
}
</script>
<script async defer src="https://hypothes.is/embed.js"></script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
{  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



<div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

<div class="book-summary">
<nav role="navigation">

<ul class="summary">
<li><center><img src="images/logo.png" alt="logo" width="50%" height="50%"style="margin: 15px 0 0 0"></center></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="1-introduction.html"><a href="1-introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-colophon.html"><a href="1.1-colophon.html"><i class="fa fa-check"></i><b>1.1</b> Colophon</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-a-very-short-introduction-to-r-and-rstudio.html"><a href="1.2-a-very-short-introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1.2</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-arosur.html"><a href="2-arosur.html"><i class="fa fa-check"></i><b>2</b> A Review of Statistics using R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-estimation-of-the-population-mean.html"><a href="2.1-estimation-of-the-population-mean.html"><i class="fa fa-check"></i><b>2.1</b> Estimation of the Population Mean</a></li>
<li class="chapter" data-level="2.2" data-path="2.2-potsm.html"><a href="2.2-potsm.html"><i class="fa fa-check"></i><b>2.2</b> Properties of the Sample Mean</a></li>
<li class="chapter" data-level="2.3" data-path="2.3-hypothesis-tests-concerning-the-population-mean.html"><a href="2.3-hypothesis-tests-concerning-the-population-mean.html"><i class="fa fa-check"></i><b>2.3</b> Hypothesis Tests Concerning the Population Mean</a>
<ul>
<li class="chapter" data-level="" data-path="2.3-hypothesis-tests-concerning-the-population-mean.html"><a href="2.3-hypothesis-tests-concerning-the-population-mean.html#the-p-value"><i class="fa fa-check"></i>The p-Value</a></li>
<li class="chapter" data-level="" data-path="2.3-hypothesis-tests-concerning-the-population-mean.html"><a href="2.3-hypothesis-tests-concerning-the-population-mean.html#calculating-the-p-value-when-the-standard-deviation-is-known"><i class="fa fa-check"></i>Calculating the p-Value when the Standard Deviation is Known</a></li>
<li class="chapter" data-level="" data-path="2.3-hypothesis-tests-concerning-the-population-mean.html"><a href="2.3-hypothesis-tests-concerning-the-population-mean.html#SVSSDASE"><i class="fa fa-check"></i>Sample Variance, Sample Standard Deviation and Standard Error</a></li>
<li class="chapter" data-level="" data-path="2.3-hypothesis-tests-concerning-the-population-mean.html"><a href="2.3-hypothesis-tests-concerning-the-population-mean.html#calculating-the-p-value-when-the-standard-deviation-is-unknown"><i class="fa fa-check"></i>Calculating the p-value When the Standard Deviation is Unknown</a></li>
<li class="chapter" data-level="" data-path="2.3-hypothesis-tests-concerning-the-population-mean.html"><a href="2.3-hypothesis-tests-concerning-the-population-mean.html#the-t-statistic"><i class="fa fa-check"></i>The t-statistic</a></li>
<li class="chapter" data-level="" data-path="2.3-hypothesis-tests-concerning-the-population-mean.html"><a href="2.3-hypothesis-tests-concerning-the-population-mean.html#hypothesis-testing-with-a-prespecified-significance-level"><i class="fa fa-check"></i>Hypothesis Testing with a Prespecified Significance Level</a></li>
<li class="chapter" data-level="" data-path="2.3-hypothesis-tests-concerning-the-population-mean.html"><a href="2.3-hypothesis-tests-concerning-the-population-mean.html#one-sided-alternatives"><i class="fa fa-check"></i>One-sided Alternatives</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2.4-confidence-intervals-for-the-population-mean.html"><a href="2.4-confidence-intervals-for-the-population-mean.html"><i class="fa fa-check"></i><b>2.4</b> Confidence Intervals for the Population Mean</a></li>
<li class="chapter" data-level="2.5" data-path="2.5-cmfdp.html"><a href="2.5-cmfdp.html"><i class="fa fa-check"></i><b>2.5</b> Comparing Means from Different Populations</a></li>
<li class="chapter" data-level="2.6" data-path="2.6-aattggoe.html"><a href="2.6-aattggoe.html"><i class="fa fa-check"></i><b>2.6</b> An Application to the Gender Gap of Earnings</a></li>
<li class="chapter" data-level="2.7" data-path="2.7-scatterplots-sample-covariance-and-sample-correlation.html"><a href="2.7-scatterplots-sample-covariance-and-sample-correlation.html"><i class="fa fa-check"></i><b>2.7</b> Scatterplots, Sample Covariance and Sample Correlation</a></li>
<li class="chapter" data-level="2.8" data-path="2.8-exercises-3.html"><a href="2.8-exercises-3.html"><i class="fa fa-check"></i><b>2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-lrwor.html"><a href="3-lrwor.html"><i class="fa fa-check"></i><b>3</b> Linear Regression with One Regressor</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-simple-linear-regression.html"><a href="3.1-simple-linear-regression.html"><i class="fa fa-check"></i><b>3.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="3.2" data-path="3.2-estimating-the-coefficients-of-the-linear-regression-model.html"><a href="3.2-estimating-the-coefficients-of-the-linear-regression-model.html"><i class="fa fa-check"></i><b>3.2</b> Estimating the Coefficients of the Linear Regression Model</a>
<ul>
<li class="chapter" data-level="" data-path="3.2-estimating-the-coefficients-of-the-linear-regression-model.html"><a href="3.2-estimating-the-coefficients-of-the-linear-regression-model.html#the-ordinary-least-squares-estimator"><i class="fa fa-check"></i>The Ordinary Least Squares Estimator</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3.3-measures-of-fit.html"><a href="3.3-measures-of-fit.html"><i class="fa fa-check"></i><b>3.3</b> Measures of Fit</a>
<ul>
<li class="chapter" data-level="" data-path="3.3-measures-of-fit.html"><a href="3.3-measures-of-fit.html#the-coefficient-of-determination"><i class="fa fa-check"></i>The Coefficient of Determination</a></li>
<li class="chapter" data-level="" data-path="3.3-measures-of-fit.html"><a href="3.3-measures-of-fit.html#the-standard-error-of-the-regression"><i class="fa fa-check"></i>The Standard Error of the Regression</a></li>
<li class="chapter" data-level="" data-path="3.3-measures-of-fit.html"><a href="3.3-measures-of-fit.html#application-to-the-test-score-data"><i class="fa fa-check"></i>Application to the Test Score Data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3.4-tlsa.html"><a href="3.4-tlsa.html"><i class="fa fa-check"></i><b>3.4</b> The Least Squares Assumptions</a>
<ul>
<li class="chapter" data-level="" data-path="3.4-tlsa.html"><a href="3.4-tlsa.html#assumption-1-the-error-term-has-conditional-mean-of-zero"><i class="fa fa-check"></i>Assumption 1: The Error Term has Conditional Mean of Zero</a></li>
<li class="chapter" data-level="" data-path="3.4-tlsa.html"><a href="3.4-tlsa.html#assumption-2-independently-and-identically-distributed-data"><i class="fa fa-check"></i>Assumption 2: Independently and Identically Distributed Data</a></li>
<li class="chapter" data-level="" data-path="3.4-tlsa.html"><a href="3.4-tlsa.html#assumption-3-large-outliers-are-unlikely"><i class="fa fa-check"></i>Assumption 3: Large Outliers are Unlikely</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3.5-tsdotoe.html"><a href="3.5-tsdotoe.html"><i class="fa fa-check"></i><b>3.5</b> The Sampling Distribution of the OLS Estimator</a>
<ul>
<li class="chapter" data-level="" data-path="3.5-tsdotoe.html"><a href="3.5-tsdotoe.html#simulation-study-1"><i class="fa fa-check"></i>Simulation Study 1</a></li>
<li class="chapter" data-level="" data-path="3.5-tsdotoe.html"><a href="3.5-tsdotoe.html#simulation-study-2"><i class="fa fa-check"></i>Simulation Study 2</a></li>
<li class="chapter" data-level="" data-path="3.5-tsdotoe.html"><a href="3.5-tsdotoe.html#simulation-study-3"><i class="fa fa-check"></i>Simulation Study 3</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="3.6-exercises-4.html"><a href="3.6-exercises-4.html"><i class="fa fa-check"></i><b>3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-htaciitslrm.html"><a href="4-htaciitslrm.html"><i class="fa fa-check"></i><b>4</b> Hypothesis Tests and Confidence Intervals in the Simple Linear Regression Model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html"><a href="4.1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html"><i class="fa fa-check"></i><b>4.1</b> Testing Two-Sided Hypotheses Concerning the Slope Coefficient</a></li>
<li class="chapter" data-level="4.2" data-path="4.2-cifrc.html"><a href="4.2-cifrc.html"><i class="fa fa-check"></i><b>4.2</b> Confidence Intervals for Regression Coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="4.2-cifrc.html"><a href="4.2-cifrc.html#simulation-study-confidence-intervals"><i class="fa fa-check"></i>Simulation Study: Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4.3-rwxiabv.html"><a href="4.3-rwxiabv.html"><i class="fa fa-check"></i><b>4.3</b> Regression when X is a Binary Variable</a></li>
<li class="chapter" data-level="4.4" data-path="4.4-hah.html"><a href="4.4-hah.html"><i class="fa fa-check"></i><b>4.4</b> Heteroskedasticity and Homoskedasticity</a>
<ul>
<li class="chapter" data-level="" data-path="4.4-hah.html"><a href="4.4-hah.html#a-real-world-example-for-heteroskedasticity"><i class="fa fa-check"></i>A Real-World Example for Heteroskedasticity</a></li>
<li class="chapter" data-level="" data-path="4.4-hah.html"><a href="4.4-hah.html#should-we-care-about-heteroskedasticity"><i class="fa fa-check"></i>Should We Care About Heteroskedasticity?</a></li>
<li class="chapter" data-level="" data-path="4.4-hah.html"><a href="4.4-hah.html#computation-of-heteroskedasticity-robust-standard-errors"><i class="fa fa-check"></i>Computation of Heteroskedasticity-Robust Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="4.5-the-gauss-markov-theorem.html"><a href="4.5-the-gauss-markov-theorem.html"><i class="fa fa-check"></i><b>4.5</b> The Gauss-Markov Theorem</a>
<ul>
<li class="chapter" data-level="" data-path="4.5-the-gauss-markov-theorem.html"><a href="4.5-the-gauss-markov-theorem.html#simulation-study-blue-estimator"><i class="fa fa-check"></i>Simulation Study: BLUE Estimator</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="4.6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html"><a href="4.6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html"><i class="fa fa-check"></i><b>4.6</b> Using the t-Statistic in Regression When the Sample Size Is Small</a></li>
<li class="chapter" data-level="4.7" data-path="4.7-exercises-5.html"><a href="4.7-exercises-5.html"><i class="fa fa-check"></i><b>4.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

</nav>
</div>

<div class="book-body">
<div class="body-inner">
<div class="book-header" role="navigation">
<h1>
<i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Econometrics with R</a>
</h1>
</div>

<div class="page-wrapper" tabindex="-1" role="main">
<div class="page-inner">

<section class="normal" id="section-">
<div class = rmdreview>
This book is in <b>Open Review</b>. We want your feedback to make the book better for you and other students. You may annotate some text by <span style="background-color: #3297FD; color: white">selecting it with the cursor</span> and then click "Annotate" in the pop-up menu. You can also see the annotations of others: click the arrow in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="potsm" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Properties of the Sample Mean<a href="2.2-potsm.html#potsm" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div class="rmdknit">
<p>A more precise way to express consistency of an estimator <span class="math inline">\(\hat\mu\)</span> for a parameter <span class="math inline">\(\mu\)</span> is</p>
<p><span class="math display">\[ P(|\hat{\mu} - \mu|&lt;\epsilon) \xrightarrow[n \rightarrow \infty]{p} 1 \quad \text{for any}\quad\epsilon&gt;0.\]</span></p>
This expression says that the probability of observing a deviation from the true value <span class="math inline">\(\mu\)</span> that is smaller than some arbitrary <span class="math inline">\(\epsilon &gt; 0\)</span> converges to <span class="math inline">\(1\)</span> as <span class="math inline">\(n\)</span> grows. Consistency does not require unbiasedness.
</div>
<p>To examine properties of the sample mean as an estimator for the corresponding population mean, consider the following <tt>R</tt> example.</p>
<p>We generate a population, denoted as <tt>pop</tt>, consisting of observations <span class="math inline">\(Y_i\)</span>, where <span class="math inline">\(i=1,\dots,10000\)</span>. These observations are generated from a normal distribution with mean <span class="math inline">\(\mu = 10\)</span> and variance <span class="math inline">\(\sigma^2 = 1\)</span>.</p>
<p>To investigate the behavior of the estimator <span class="math inline">\(\hat{\mu} = \bar{Y}\)</span> we can draw random samples from this population and calculate <span class="math inline">\(\bar{Y}\)</span> for each of them. This is easily done by making use of the function <tt>replicate()</tt>. The argument <tt>expr</tt> is evaluated <tt>n</tt> times. In this case we draw samples of sizes <span class="math inline">\(n=5\)</span> and <span class="math inline">\(n=25\)</span>, compute the sample means and repeat this exactly <span class="math inline">\(N=25000\)</span> times.</p>
<p>For comparison purposes we store results for the estimator <span class="math inline">\(Y_1\)</span>, the first observation in a sample for a sample of size <span class="math inline">\(5\)</span>, separately.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="2.2-potsm.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a fictious population</span></span>
<span id="cb10-2"><a href="2.2-potsm.html#cb10-2" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">10</span>, <span class="dv">1</span>)</span>
<span id="cb10-3"><a href="2.2-potsm.html#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="2.2-potsm.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sample from the population and estimate the mean</span></span>
<span id="cb10-5"><a href="2.2-potsm.html#cb10-5" aria-hidden="true" tabindex="-1"></a>est1 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">expr =</span> <span class="fu">mean</span>(<span class="fu">sample</span>(<span class="at">x =</span> pop, <span class="at">size =</span> <span class="dv">5</span>)), <span class="at">n =</span> <span class="dv">25000</span>)</span>
<span id="cb10-6"><a href="2.2-potsm.html#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="2.2-potsm.html#cb10-7" aria-hidden="true" tabindex="-1"></a>est2 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">expr =</span> <span class="fu">mean</span>(<span class="fu">sample</span>(<span class="at">x =</span> pop, <span class="at">size =</span> <span class="dv">25</span>)), <span class="at">n =</span> <span class="dv">25000</span>)</span>
<span id="cb10-8"><a href="2.2-potsm.html#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="2.2-potsm.html#cb10-9" aria-hidden="true" tabindex="-1"></a>fo <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">expr =</span> <span class="fu">sample</span>(<span class="at">x =</span> pop, <span class="at">size =</span> <span class="dv">5</span>)[<span class="dv">1</span>], <span class="at">n =</span> <span class="dv">25000</span>)</span></code></pre></div>
<p>Check that <tt>est1</tt> and <tt>est2</tt> are vectors of length <span class="math inline">\(25000\)</span>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="2.2-potsm.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if object type is vector</span></span>
<span id="cb11-2"><a href="2.2-potsm.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.vector</span>(est1)</span>
<span id="cb11-3"><a href="2.2-potsm.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb11-4"><a href="2.2-potsm.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">is.vector</span>(est2)</span>
<span id="cb11-5"><a href="2.2-potsm.html#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb11-6"><a href="2.2-potsm.html#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="2.2-potsm.html#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># check length</span></span>
<span id="cb11-8"><a href="2.2-potsm.html#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(est1)</span>
<span id="cb11-9"><a href="2.2-potsm.html#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 25000</span></span>
<span id="cb11-10"><a href="2.2-potsm.html#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(est2)</span>
<span id="cb11-11"><a href="2.2-potsm.html#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 25000</span></span></code></pre></div>
<p>The code chunk below produces a plot of the sampling distributions of the estimators <span class="math inline">\(\bar{Y}\)</span> and <span class="math inline">\(Y_1\)</span> on the basis of the <span class="math inline">\(25000\)</span> samples in each case. We also plot the density function of the <span class="math inline">\(\mathcal{N}(10,1)\)</span> distribution.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="2.2-potsm.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot density estimate Y_1</span></span>
<span id="cb12-2"><a href="2.2-potsm.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(fo), </span>
<span id="cb12-3"><a href="2.2-potsm.html#cb12-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, </span>
<span id="cb12-4"><a href="2.2-potsm.html#cb12-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb12-5"><a href="2.2-potsm.html#cb12-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb12-6"><a href="2.2-potsm.html#cb12-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Estimates&quot;</span>,</span>
<span id="cb12-7"><a href="2.2-potsm.html#cb12-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;Sampling Distributions of Unbiased Estimators&quot;</span>)</span>
<span id="cb12-8"><a href="2.2-potsm.html#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="2.2-potsm.html#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add density estimate for the distribution of the sample mean with n=5 to the plot</span></span>
<span id="cb12-10"><a href="2.2-potsm.html#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(est1), </span>
<span id="cb12-11"><a href="2.2-potsm.html#cb12-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb12-12"><a href="2.2-potsm.html#cb12-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb12-13"><a href="2.2-potsm.html#cb12-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb12-14"><a href="2.2-potsm.html#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="2.2-potsm.html#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># add density estimate for the distribution of the sample mean with n=25 to the plot</span></span>
<span id="cb12-16"><a href="2.2-potsm.html#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(est2), </span>
<span id="cb12-17"><a href="2.2-potsm.html#cb12-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red2&quot;</span>, </span>
<span id="cb12-18"><a href="2.2-potsm.html#cb12-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb12-19"><a href="2.2-potsm.html#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="2.2-potsm.html#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co"># add a vertical line at the true parameter</span></span>
<span id="cb12-21"><a href="2.2-potsm.html#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">10</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb12-22"><a href="2.2-potsm.html#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="2.2-potsm.html#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co"># add N(10,1) density to the plot</span></span>
<span id="cb12-24"><a href="2.2-potsm.html#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">10</span>), </span>
<span id="cb12-25"><a href="2.2-potsm.html#cb12-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb12-26"><a href="2.2-potsm.html#cb12-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb12-27"><a href="2.2-potsm.html#cb12-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">add =</span> T)</span>
<span id="cb12-28"><a href="2.2-potsm.html#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="2.2-potsm.html#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb12-30"><a href="2.2-potsm.html#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb12-31"><a href="2.2-potsm.html#cb12-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;N(10,1)&quot;</span>,</span>
<span id="cb12-32"><a href="2.2-potsm.html#cb12-32" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">expression</span>(Y[n <span class="sc">==</span> <span class="dv">1</span>]),</span>
<span id="cb12-33"><a href="2.2-potsm.html#cb12-33" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">expression</span>(<span class="fu">bar</span>(Y)[n <span class="sc">==</span> <span class="dv">5</span>]),</span>
<span id="cb12-34"><a href="2.2-potsm.html#cb12-34" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">expression</span>(<span class="fu">bar</span>(Y)[n <span class="sc">==</span> <span class="dv">25</span>])</span>
<span id="cb12-35"><a href="2.2-potsm.html#cb12-35" aria-hidden="true" tabindex="-1"></a>                  ), </span>
<span id="cb12-36"><a href="2.2-potsm.html#cb12-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb12-37"><a href="2.2-potsm.html#cb12-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;green&quot;</span>, <span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;red2&quot;</span>),</span>
<span id="cb12-38"><a href="2.2-potsm.html#cb12-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-23-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>First, <em>all</em> sampling distributions (represented by the solid lines) are centered around <span class="math inline">\(\mu = 10\)</span>. This is evidence for the <em>unbiasedness</em> of <span class="math inline">\(Y_1\)</span>, <span class="math inline">\(\overline{Y}_{5}\)</span> and <span class="math inline">\(\overline{Y}_{25}\)</span>. Of course, the theoretical density <span class="math inline">\(\mathcal{N}(10,1)\)</span> is centered at <span class="math inline">\(10\)</span>, too.</p>
<p>Next, have a look at the spread of the sampling distributions. Several things are noteworthy:</p>
<ul>
<li><p>The sampling distribution of <span class="math inline">\(Y_1\)</span> (green curve) tracks the density of the <span class="math inline">\(\mathcal{N}(10,1)\)</span> distribution (black dashed line) pretty closely. In fact, the sampling distribution of <span class="math inline">\(Y_1\)</span> is the <span class="math inline">\(\mathcal{N}(10,1)\)</span> distribution. This is less surprising if you keep in mind that the <span class="math inline">\(Y_1\)</span> estimator does nothing but reporting an observation that is randomly selected from a population with <span class="math inline">\(\mathcal{N}(10,1)\)</span> distribution. Hence, <span class="math inline">\(Y_1 \sim \mathcal{N}(10,1)\)</span>. Note that this result does not depend on the sample size <span class="math inline">\(n\)</span>: the sampling distribution of <span class="math inline">\(Y_1\)</span> <em>is always</em> the population distribution, no matter how large the sample is. <span class="math inline">\(Y_1\)</span> is a good a estimate of <span class="math inline">\(\mu_Y\)</span>, but we can do better.</p></li>
<li><p>Both sampling distributions of <span class="math inline">\(\overline{Y}\)</span> show less dispersion than the sampling distribution of <span class="math inline">\(Y_1\)</span>. This means that <span class="math inline">\(\overline{Y}\)</span> has a lower variance than <span class="math inline">\(Y_1\)</span>. In view of Key Concepts 3.2 and 3.3, we find that <span class="math inline">\(\overline{Y}\)</span> is a more efficient estimator than <span class="math inline">\(Y_1\)</span>. In fact, this holds for all <span class="math inline">\(n&gt;1\)</span>.</p></li>
<li><p><span class="math inline">\(\overline{Y}\)</span> shows a behavior illustrating consistency (see Key Concept 3.2). The blue and the red densities are much more concentrated around <span class="math inline">\(\mu=10\)</span> than the green one. As the number of observations is increased from <span class="math inline">\(1\)</span> to <span class="math inline">\(5\)</span>, the sampling distribution tightens around the true parameter. Increasing the sample size to <span class="math inline">\(25\)</span>, this effect becomes more apparent. This implies that the probability of obtaining estimates that are close to the true value increases with <span class="math inline">\(n\)</span>. This is also reflected by the estimated values of the density function close to 10: the larger the sample size, the larger the value of the density.</p></li>
</ul>
<p>We encourage you to go ahead and modify the code. Try out different values for the sample size and see how the sampling distribution of <span class="math inline">\(\overline{Y}\)</span> changes!</p>
<div id="overliney-is-the-least-squares-estimator-of-mu_y" class="section level4 unnumbered hasAnchor">
<h4><span class="math inline">\(\overline{Y}\)</span> is the Least Squares Estimator of <span class="math inline">\(\mu_Y\)</span><a href="2.2-potsm.html#overliney-is-the-least-squares-estimator-of-mu_y" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Assume you have some observations <span class="math inline">\(Y_1,\dots,Y_n\)</span> on <span class="math inline">\(Y \sim \mathcal{N}(10,1)\)</span> (which is unknown) and would like to find an estimator <span class="math inline">\(m\)</span> that predicts the observations as well as possible. Here, we aim to find an estimator <span class="math inline">\(m\)</span> that results in a small total squared deviation between the predicted and observed values. Mathematically, this means we want to find an <span class="math inline">\(m\)</span> that minimizes</p>
<p><span class="math display" id="eq:sqm">\[\begin{equation}
\sum_{i=1}^n (Y_i - m)^2. \tag{2.1}
\end{equation}\]</span></p>
<p>Think of <span class="math inline">\(Y_i - m\)</span> as the mistake made when predicting <span class="math inline">\(Y_i\)</span> by <span class="math inline">\(m\)</span>. We could also minimize the sum of absolute deviations from <span class="math inline">\(m\)</span> but minimizing the sum of squared deviations is mathematically more convenient (and will lead to a different result). That is why the estimator we are looking for is called the <em>least squares estimator</em>. <span class="math inline">\(m = \overline{Y}\)</span>, the sample mean, is this estimator.</p>
<p>We can show this by generating a random sample and plotting <a href="2.2-potsm.html#eq:sqm">(2.1)</a> as a function of <span class="math inline">\(m\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="2.2-potsm.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the function and vectorize it</span></span>
<span id="cb13-2"><a href="2.2-potsm.html#cb13-2" aria-hidden="true" tabindex="-1"></a>sqm <span class="ot">&lt;-</span> <span class="cf">function</span>(m) {</span>
<span id="cb13-3"><a href="2.2-potsm.html#cb13-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">sum</span>((y<span class="sc">-</span>m)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-4"><a href="2.2-potsm.html#cb13-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-5"><a href="2.2-potsm.html#cb13-5" aria-hidden="true" tabindex="-1"></a>sqm <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(sqm)</span>
<span id="cb13-6"><a href="2.2-potsm.html#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="2.2-potsm.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># draw random sample and compute the mean</span></span>
<span id="cb13-8"><a href="2.2-potsm.html#cb13-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">1</span>)</span>
<span id="cb13-9"><a href="2.2-potsm.html#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span>
<span id="cb13-10"><a href="2.2-potsm.html#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 10.1364</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="2.2-potsm.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the objective function</span></span>
<span id="cb14-2"><a href="2.2-potsm.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">sqm</span>(x), </span>
<span id="cb14-3"><a href="2.2-potsm.html#cb14-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="sc">-</span><span class="dv">50</span>, </span>
<span id="cb14-4"><a href="2.2-potsm.html#cb14-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">to =</span> <span class="dv">70</span>,</span>
<span id="cb14-5"><a href="2.2-potsm.html#cb14-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;m&quot;</span>,</span>
<span id="cb14-6"><a href="2.2-potsm.html#cb14-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;sqm(m)&quot;</span>)</span>
<span id="cb14-7"><a href="2.2-potsm.html#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="2.2-potsm.html#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add vertical line at mean(y)</span></span>
<span id="cb14-9"><a href="2.2-potsm.html#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(y), </span>
<span id="cb14-10"><a href="2.2-potsm.html#cb14-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">2</span>, </span>
<span id="cb14-11"><a href="2.2-potsm.html#cb14-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb14-12"><a href="2.2-potsm.html#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="2.2-potsm.html#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add annotation at mean(y)</span></span>
<span id="cb14-14"><a href="2.2-potsm.html#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">mean</span>(y), </span>
<span id="cb14-15"><a href="2.2-potsm.html#cb14-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="dv">0</span>, </span>
<span id="cb14-16"><a href="2.2-potsm.html#cb14-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">mean</span>(y), <span class="dv">2</span>)))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-25-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Notice that <a href="2.2-potsm.html#eq:sqm">(2.1)</a> is a quadratic function so that there is only one minimum. The plot shows that this minimum lies exactly at the sample mean of the sample data.</p>

<div class="rmdknit">
<p>Some <tt>R</tt> functions can only interact with functions that take a vector as an input and evaluate the function body on every entry of the vector, for example <tt>curve()</tt>. We call such functions vectorized functions and it is often a good idea to write vectorized functions yourself, although this is cumbersome in some cases. Having a vectorized function in <tt>R</tt> is never a drawback since these functions work on both single values and vectors.</p>
<p>Let us look at the function <tt>sqm()</tt>, which is non-vectorized:</p>
<p><tt>
sqm &lt;- function(m) {<br />
sum((y-m)^2) #body of the function<br />
}
</tt></p>
<p>Providing, e.g., <tt>c(1,2,3)</tt> as the argument <tt>m</tt> would cause an error since then the operation <tt>y-m</tt> is invalid: the vectors <tt>y</tt> and <tt>m</tt> are of incompatible dimensions. This is why we cannot use <tt>sqm()</tt> in conjunction with <tt>curve()</tt>.</p>
Here <tt>Vectorize()</tt> comes into play. It generates a vectorized version of a non-vectorized function.
</div>
</div>
<div id="why-random-sampling-is-important" class="section level4 unnumbered hasAnchor">
<h4>Why Random Sampling is Important<a href="2.2-potsm.html#why-random-sampling-is-important" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>So far, we assumed (sometimes implicitly) that the observed data <span class="math inline">\(Y_1, \dots, Y_n\)</span> are the result of a sampling process that satisfies the assumption of simple random sampling. This assumption often is fulfilled when estimating a population mean using <span class="math inline">\(\overline{Y}\)</span>. If this is not the case, estimates may be biased.</p>
<p>Let us fall back to <tt>pop</tt>, the fictitious population of <span class="math inline">\(10000\)</span> observations and compute the population mean <span class="math inline">\(\mu_{\texttt{pop}}\)</span>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="2.2-potsm.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the population mean of pop</span></span>
<span id="cb15-2"><a href="2.2-potsm.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pop)</span>
<span id="cb15-3"><a href="2.2-potsm.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 9.992604</span></span></code></pre></div>
<p>Next we sample <span class="math inline">\(25\)</span> observations from <tt>pop</tt> with <tt>sample()</tt> and estimate <span class="math inline">\(\mu_{\texttt{pop}}\)</span> using <span class="math inline">\(\overline{Y}\)</span> repeatedly. However, now we use a sampling scheme that deviates from simple random sampling: instead of ensuring that each member of the population has the same chance to end up in a sample, we assign a higher probability of being sampled to the <span class="math inline">\(2500\)</span> smallest observations of the population by setting the argument <tt>prob</tt> to a suitable vector of probability weights:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="2.2-potsm.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate outcomes for the sample mean when the i.i.d. assumption fails</span></span>
<span id="cb16-2"><a href="2.2-potsm.html#cb16-2" aria-hidden="true" tabindex="-1"></a>est3 <span class="ot">&lt;-</span>  <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">25000</span>, </span>
<span id="cb16-3"><a href="2.2-potsm.html#cb16-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">expr =</span> <span class="fu">mean</span>(<span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">sort</span>(pop), </span>
<span id="cb16-4"><a href="2.2-potsm.html#cb16-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">size =</span> <span class="dv">25</span>, </span>
<span id="cb16-5"><a href="2.2-potsm.html#cb16-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">prob =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">2500</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">7500</span>)))))</span>
<span id="cb16-6"><a href="2.2-potsm.html#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="2.2-potsm.html#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the sample mean of the outcomes</span></span>
<span id="cb16-8"><a href="2.2-potsm.html#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(est3)</span>
<span id="cb16-9"><a href="2.2-potsm.html#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 9.443067</span></span></code></pre></div>
<p>Next we plot the sampling distribution of <span class="math inline">\(\overline{Y}\)</span> for this non-i.i.d. case and compare it to the sampling distribution when the i.i.d. assumption holds.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="2.2-potsm.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sampling distribution of sample mean, i.i.d. holds, n=25</span></span>
<span id="cb17-2"><a href="2.2-potsm.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(est2), </span>
<span id="cb17-3"><a href="2.2-potsm.html#cb17-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb17-4"><a href="2.2-potsm.html#cb17-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb17-5"><a href="2.2-potsm.html#cb17-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">11</span>),</span>
<span id="cb17-6"><a href="2.2-potsm.html#cb17-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Estimates&quot;</span>,</span>
<span id="cb17-7"><a href="2.2-potsm.html#cb17-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;When the i.i.d. Assumption Fails&quot;</span>)</span>
<span id="cb17-8"><a href="2.2-potsm.html#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="2.2-potsm.html#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># sampling distribution of sample mean, i.i.d. fails, n=25</span></span>
<span id="cb17-10"><a href="2.2-potsm.html#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(est3),</span>
<span id="cb17-11"><a href="2.2-potsm.html#cb17-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red2&quot;</span>,</span>
<span id="cb17-12"><a href="2.2-potsm.html#cb17-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb17-13"><a href="2.2-potsm.html#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="2.2-potsm.html#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb17-15"><a href="2.2-potsm.html#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb17-16"><a href="2.2-potsm.html#cb17-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(Y)[n <span class="sc">==</span> <span class="dv">25</span>]<span class="sc">~</span><span class="st">&quot;, i.i.d. fails&quot;</span>),</span>
<span id="cb17-17"><a href="2.2-potsm.html#cb17-17" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">expression</span>(<span class="fu">bar</span>(Y)[n <span class="sc">==</span> <span class="dv">25</span>]<span class="sc">~</span><span class="st">&quot;, i.i.d. holds&quot;</span>)</span>
<span id="cb17-18"><a href="2.2-potsm.html#cb17-18" aria-hidden="true" tabindex="-1"></a>                  ), </span>
<span id="cb17-19"><a href="2.2-potsm.html#cb17-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb17-20"><a href="2.2-potsm.html#cb17-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red2&quot;</span>, <span class="st">&quot;steelblue&quot;</span>),</span>
<span id="cb17-21"><a href="2.2-potsm.html#cb17-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-28-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Here, the failure of the i.i.d. assumption implies that, on average, we <em>underestimate</em> <span class="math inline">\(\mu_Y\)</span> using <span class="math inline">\(\overline{Y}\)</span>: the corresponding distribution of <span class="math inline">\(\overline{Y}\)</span> is shifted to the left. In other words, <span class="math inline">\(\overline{Y}\)</span> is a <em>biased</em> estimator for <span class="math inline">\(\mu_Y\)</span> if the i.i.d. assumption does not hold.</p>
</div>
</div>
</section>

</div>
</div>
</div>
<a href="2.1-estimation-of-the-population-mean.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="2.3-hypothesis-tests-concerning-the-population-mean.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
</div>
</div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/mca91/EconometricsWithR/edit/master/03-ch3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ITER.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
var script = document.createElement("script");
script.type = "text/javascript";
var src = "true";
if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
if (location.protocol !== "file:")
if (/^https?:/.test(src))
src = src.replace(/^https?:/, '');
script.src = src;
document.getElementsByTagName("head")[0].appendChild(script);
})();
</script>
</body>

</html>
